<!DOCTYPE html>
<html lang="Chinese">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.0.0-rc1">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"hfcherish.github.io","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.15.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="从心所欲不逾矩">
<meta property="og:type" content="website">
<meta property="og:title" content="Cherish&#39;s Blog">
<meta property="og:url" content="http://hfcherish.github.io/page/3/index.html">
<meta property="og:site_name" content="Cherish&#39;s Blog">
<meta property="og:description" content="从心所欲不逾矩">
<meta property="og:locale">
<meta property="article:author" content="Cherish">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://hfcherish.github.io/page/3/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"Chinese","comments":"","permalink":"","path":"page/3/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Cherish's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Cherish's Blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Cherish</p>
  <div class="site-description" itemprop="description">从心所欲不逾矩</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">64</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">53</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="sidebar-button animated">
    <button><i class="fa fa-comment"></i>
      Chat
    </button>
  </div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/hfcherish" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hfcherish" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:pzcherishhf@gmail.com" title="E-Mail → mailto:pzcherishhf@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://hfcherish.github.io/2020/04/27/502-vs-504/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Cherish">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cherish's Blog">
      <meta itemprop="description" content="从心所欲不逾矩">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Cherish's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/04/27/502-vs-504/" class="post-title-link" itemprop="url">nginx 502 vs 504</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-04-27 13:57:12" itemprop="dateCreated datePublished" datetime="2020-04-27T13:57:12+08:00">2020-04-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-10-22 14:22:52" itemprop="dateModified" datetime="2022-10-22T14:22:52+08:00">2022-10-22</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="WORDS">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">WORDS:</span>
      <span>0</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a href="https://juejin.im/post/5b54635ae51d451951133d85">nginx 502 和 504 超时演示</a></p>
<blockquote>
<p>502 Bad Gateway: The server was acting as a <a href="https://www.wikiwand.com/en/Gateway_(telecommunications)">gateway</a> or proxy and received an invalid response from the upstream server.</p>
<p>504: he server was acting as a gateway or proxy and did not receive a timely response from the upstream server.</p>
</blockquote>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p><strong>504 是 nginx 没有及时从上游服务获取响应，超时了：</strong></p>
<ul>
<li>上游服务响应慢，读取 response &#x2F; 发送 request 超时（<code>upstream timed out (110: Operation timed out) **while** reading response header from upstream</code>）<ul>
<li>某些请求处理就是慢。此时就应该调大 <a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_read_timeout"><strong>proxy_read_timeout</strong></a> (默认 60s)</li>
<li>上游服务压力太大，响应变慢。此时可以增加上游服务的响应能力，也可以适当提升 <a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_send_timeout"><strong>proxy_send_timeout</strong></a>, <a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_read_timeout"><strong>proxy_read_timeout</strong></a></li>
</ul>
</li>
<li>连接上游服务超时。可能是上游服务已经断了，但由于 keepalive，nginx 依然保有 tcp 连接，但实际操作时，却连不上，就超时了。</li>
</ul>
<p><strong>502 是一般是上游服务器故障导致的</strong>。比如停机，进程被杀死，上游服务 reset 了连接，进程僵死等各种原因。在 nginx 的日志中我们能够发现 502 错误的具体原因，分别为：<code>104: Connection reset by peer</code>，<code>113: Host is unreachable</code>，<code>111: Connection refused</code></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://hfcherish.github.io/2020/03/10/yield/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Cherish">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cherish's Blog">
      <meta itemprop="description" content="从心所欲不逾矩">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Cherish's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/03/10/yield/" class="post-title-link" itemprop="url">c# contextual keywords: yield</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-03-10 11:19:31" itemprop="dateCreated datePublished" datetime="2020-03-10T11:19:31+08:00">2020-03-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-10-22 14:22:52" itemprop="dateModified" datetime="2022-10-22T14:22:52+08:00">2022-10-22</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="WORDS">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">WORDS:</span>
      <span>0</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/yield">yield</a> is a contextual keywords. When it shows in a statement, it means the method or get accessor in which it appears is an iterator. Thus it provides a simple way to define an iterator, rather than a class that implements <code>IEnumerable</code> or <code>IEnumerator</code>.</p>
<blockquote>
<p>When you use the <code>yield</code> <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/#contextual-keywords">contextual keyword</a> in a statement, you indicate that the method, operator, or <code>get</code> accessor in which it appears is an iterator. Using <code>yield</code> to define an iterator removes the need for an explicit extra class (the class that holds the state for an enumeration, see <a href="https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.ienumerator-1">IEnumerator</a> for an example) when you implement the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.collections.ienumerable">IEnumerable</a> and <a href="https://docs.microsoft.com/en-us/dotnet/api/system.collections.ienumerator">IEnumerator</a> pattern for a custom collection type.</p>
</blockquote>
<h2 id="Grammar"><a href="#Grammar" class="headerlink" title="Grammar"></a>Grammar</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">yield</span> <span class="keyword">return</span> expression;	<span class="comment">// return an element in the iterator</span></span><br><span class="line"><span class="keyword">yield</span> <span class="keyword">break</span>;	<span class="comment">// end the iterator</span></span><br></pre></td></tr></table></figure>



<h2 id="Q-amp-A"><a href="#Q-amp-A" class="headerlink" title="Q &amp; A"></a>Q &amp; A</h2><h4 id="What’s-an-iterator"><a href="#What’s-an-iterator" class="headerlink" title="What’s an iterator?"></a>What’s an iterator?</h4><p>An iterator means that it can be looped in <code>foreach</code> or LINQ query. In this case, it means the method or get accessor containing <code>yield</code> can be consumed by <code>foreach</code> or LINQ query.</p>
<h4 id="what-does-yield-means-in-this-iterator"><a href="#what-does-yield-means-in-this-iterator" class="headerlink" title="what does yield means in this iterator?"></a>what does <code>yield</code> means in this iterator?</h4><p>The <code>yield return</code> will return an element in the iterator. During the loop, the iterator use <code>MoveNext</code> to get i (take <a href="#yield-in-method">power method</a> as an example), and the <code>MoveNext</code> stop at the next <code>yield return</code> expression, and the <code>Current</code> property of the iterator is updated as this value, too.</p>
<h4 id="when-does-the-iterator-stopped"><a href="#when-does-the-iterator-stopped" class="headerlink" title="when does the iterator stopped?"></a>when does the iterator stopped?</h4><ul>
<li>when there’s <code>yield break</code></li>
<li>when the method body is end</li>
</ul>
<h4 id="what’s-the-requirements-to-define-such-iterator"><a href="#what’s-the-requirements-to-define-such-iterator" class="headerlink" title="what’s the requirements to define such iterator?"></a>what’s the requirements to define such iterator?</h4><ul>
<li>The return type must be <a href="https://docs.microsoft.com/en-us/dotnet/api/system.collections.ienumerable">IEnumerable</a>, <a href="https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.ienumerable-1">IEnumerable</a>, <a href="https://docs.microsoft.com/en-us/dotnet/api/system.collections.ienumerator">IEnumerator</a>, or <a href="https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.ienumerator-1">IEnumerator</a>.</li>
<li>The declaration can’t have any <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/in-parameter-modifier">in</a> <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/ref">ref</a> or <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/out-parameter-modifier">out</a> parameters.</li>
<li>Don’t use <code>yield</code> in <a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/statements-expressions-operators/lambda-expressions">Lambda expressions</a> and <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/delegate-operator">anonymous methods</a>.</li>
<li>Don’t use <code>yield</code> in methods that contain unsafe blocks. For more information, see <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/unsafe">unsafe</a>.</li>
<li>Don’t use <code>yield return</code> in a try-catch block. A <code>yield return</code> statement can be located in the try block of a try-finally statement.</li>
<li><code>yield break</code> can be located in a try block or a catch block but not a finally block</li>
</ul>
<h1 id="examples"><a href="#examples" class="headerlink" title="examples"></a>examples</h1><h3 id="yield-in-method"><a href="#yield-in-method" class="headerlink" title="yield in method"></a>yield in method<a name = 'yield-in-method' /></h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  	<span class="keyword">var</span> powers = Power(<span class="number">2</span>, <span class="number">10</span>);	<span class="comment">// won&#x27;t execute the body of Power</span></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">var</span> i <span class="keyword">in</span> powers)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;<span class="subst">&#123;i&#125;</span> &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// =================== yield in method ========================</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IEnumerable&lt;<span class="built_in">int</span>&gt; <span class="title">Power</span>(<span class="params"><span class="built_in">int</span> number, <span class="built_in">int</span> exponent</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> result = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; exponent; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        result = result * number;</span><br><span class="line">        <span class="keyword">yield</span> <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="yield-in-get-accessor"><a href="#yield-in-get-accessor" class="headerlink" title="yield in get accessor"></a>yield in get accessor<a name = 'yield-in-get-accessor' /></h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="function"><span class="keyword">var</span> i <span class="keyword">in</span> <span class="keyword">new</span> <span class="title">Galaxies</span>().AllGalaxies)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;<span class="subst">&#123;i.Name&#125;</span>, <span class="subst">&#123;i.Age&#125;</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Galaxies</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// =================== yield in get accessor ========================</span></span><br><span class="line">    <span class="keyword">public</span> IEnumerable&lt;Galaxy&gt; AllGalaxies</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="function"><span class="keyword">yield</span> <span class="keyword">return</span> <span class="keyword">new</span> <span class="title">Galaxy</span>(<span class="params"><span class="string">&quot;The milky way&quot;</span>, <span class="number">1000</span></span>)</span>;</span><br><span class="line">            <span class="function"><span class="keyword">yield</span> <span class="keyword">return</span> <span class="keyword">new</span> <span class="title">Galaxy</span>(<span class="params"><span class="string">&quot;Tadpole&quot;</span>, <span class="number">1000</span></span>)</span>;</span><br><span class="line">            <span class="function"><span class="keyword">yield</span> <span class="keyword">return</span> <span class="keyword">new</span> <span class="title">Galaxy</span>(<span class="params"><span class="string">&quot;Andromeda&quot;</span>, <span class="number">1000</span></span>)</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Galaxy</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Age &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Galaxy</span>(<span class="params"><span class="built_in">string</span> name, <span class="built_in">int</span> age</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Name = name;</span><br><span class="line">        Age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://hfcherish.github.io/2020/01/17/FluentValidator/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Cherish">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cherish's Blog">
      <meta itemprop="description" content="从心所欲不逾矩">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Cherish's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/01/17/FluentValidator/" class="post-title-link" itemprop="url">FluentValidator</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-01-17 16:36:43" itemprop="dateCreated datePublished" datetime="2020-01-17T16:36:43+08:00">2020-01-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-10-22 14:22:52" itemprop="dateModified" datetime="2022-10-22T14:22:52+08:00">2022-10-22</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="WORDS">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">WORDS:</span>
      <span>0</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a href="https://fluentvalidation.net/start#setting-the-cascade-mode">FluentValidation</a></p>
<h1 id="Knowledge"><a href="#Knowledge" class="headerlink" title="Knowledge"></a>Knowledge</h1><ul>
<li>The <code>RuleFor</code> method create a validation rule.</li>
</ul>
<blockquote>
<p>To specify a validation rule for a particular property, call the <code>RuleFor</code> method, passing a lambda expression that indicates the property that you wish to validate. </p>
</blockquote>
<ul>
<li>Rules are run syncronously</li>
</ul>
<blockquote>
<p>By default, all rules in FluentValidation are separate and cannot influence one another. This is intentional and necessary for asynchronous validation to work.</p>
</blockquote>
<ul>
<li><code>Must</code>, <code>NotNull</code>…. are <a href="https://fluentvalidation.net/built-in-validators">built-in validators</a>. <code>WithMessage</code> is a method on a validator. <code>When</code> defines condition for validator(s).</li>
<li>Append multiple validators on a same property are called chaining validators.</li>
<li>Chainning Validators are executed by sequence. <code>CascadeMode</code> can define how these chaining validators are exectued. <code>Continue</code> is default which means even a validator fail, the latter validators will still be invoked. <code>StopOnFirstFailure</code> will stop at the first failure of these chaining validators.</li>
<li><code>When</code> defines condition for validator(s)&#x2F;rules. <code>ApplyConditionTo.AllValidators</code> is the default setting. <code>ApplyConditionTo.CurrentValidator</code>  will make the condition only work to the preceding validator.</li>
</ul>
<blockquote>
<p>By default FluentValidation will apply the condition to all preceding validators in the same call to <code>RuleFor</code></p>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://hfcherish.github.io/2019/06/05/c-sharp-basic/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Cherish">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cherish's Blog">
      <meta itemprop="description" content="从心所欲不逾矩">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Cherish's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/06/05/c-sharp-basic/" class="post-title-link" itemprop="url">c# basic</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-06-05 17:11:28" itemprop="dateCreated datePublished" datetime="2019-06-05T17:11:28+08:00">2019-06-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-10-22 14:22:52" itemprop="dateModified" datetime="2022-10-22T14:22:52+08:00">2022-10-22</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="WORDS">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">WORDS:</span>
      <span>0</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="net-asp-net-c"><a href="#net-asp-net-c" class="headerlink" title=".net, asp.net, c#"></a>.net, asp.net, c#</h1><p>c# is like java language specification;</p>
<p>.net is like jdk&#x2F;javase&#x2F;javaee</p>
<p><a href="https://dotnet.microsoft.com/apps/aspnet">asp.net</a>: is like springboot</p>
<ol>
<li><a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/statements-expressions-operators/default-value-expressions">default</a>, as, is</li>
<li>sln: solution ——&gt; csproj: c sharp project ——&gt; files <a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/statements-expressions-operators/default-value-expressions">.sln vs .csproj</a></li>
</ol>
<h1 id="Key-concepts"><a href="#Key-concepts" class="headerlink" title="Key concepts"></a>Key concepts</h1><p>ref: <a href="https://blog.csdn.net/baidu_32134295/article/details/51285603">c# concepts</a></p>
<ul>
<li><strong>solution</strong>: a complete application, similar to maven project. It contains several c# project like frontend, backend, library to compose a complete application.</li>
<li><strong>project</strong>: similar to maven module. It can be a web project, a library, a windows program, etc.</li>
<li><strong>assembly</strong>: similar to maven jar. A c# project is corresponding to an assembly. An assembly can be a <code>dll</code>, <code>exe</code>, etc.</li>
<li><strong>namespace</strong>: similar to java package. It’s a logical concept to avoid naming conflicts while assembly is a physical concept. A namespace can be in different assemblies and an assembly can contains multiple namespaces.</li>
</ul>
<h1 id="Accessibility-levels"><a href="#Accessibility-levels" class="headerlink" title="Accessibility levels"></a>Accessibility levels</h1><p>ref: <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/accessibility-levels">accessibility levels</a></p>
<ul>
<li><strong>public</strong>: access is not restricted. (all)</li>
<li><strong>private</strong>: limited to containing type (only self)</li>
<li><strong>protected</strong>: limited to the containing class and types derived from the containing class. (sub-classes)</li>
<li><strong>internal</strong>: limited to the current assembly (only the same assembly)</li>
<li><strong>protected internal</strong>: limited to the current assembly or types derived from the containing class (same assembly &amp; sub-classes)</li>
<li><strong>protected private</strong>: limited to the containing class and types derived from the containing class in the current assembly (sub-classes in same assembly)</li>
</ul>
<h1 id="data-types"><a href="#data-types" class="headerlink" title="data types"></a>data types</h1><h2 id="Nullable"><a href="#Nullable" class="headerlink" title="Nullable"></a>Nullable</h2><p><a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/nullable-types/">Nullable<T></a> (T?): similar to Optional in java, but the T can only be <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/language-specification/introduction#types-and-variables">value type</a>, which are simple types, enum types, struct types, and nullable types. Because value type has no null value (not alike reference type — — object), and there’re situations when their values are undefined, nullable is born.</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span>? x = <span class="literal">null</span>    <span class="comment">// int? is the shorthand for Nullable&lt;int&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Delegate"><a href="#Delegate" class="headerlink" title="Delegate"></a>Delegate</h2><p><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/language-specification/introduction#delegates">delegate</a> is like <code>@FunctionalInterface</code> in java.</p>
<blockquote>
<p>A <em><strong>delegate type</strong></em> represents references to methods with a particular parameter list and return type. Delegates make it possible to treat methods as entities that can be assigned to variables and passed as parameters. </p>
</blockquote>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="built_in">delegate</span> <span class="built_in">double</span> <span class="title">Function</span>(<span class="params"><span class="built_in">double</span> x</span>)</span>;    <span class="comment">// functional interface definition</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="built_in">double</span>[] <span class="title">Apply</span>(<span class="params"><span class="built_in">double</span>[] a, Function f</span>)</span> &#123;&#125;  <span class="comment">// use delegate as a method param</span></span><br><span class="line"></span><br><span class="line">Apply(&#123;<span class="number">0.0</span>, <span class="number">0.5</span>, <span class="number">1.0</span>&#125;, (<span class="built_in">double</span> x) -&gt; x*x);   <span class="comment">// define an anoymous function</span></span><br></pre></td></tr></table></figure>

<h1 id="Method"><a href="#Method" class="headerlink" title="Method"></a>Method</h1><p><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/language-specification/introduction#methods">Method</a> contains parameters &amp; return type &amp; body &amp; modifier &amp; type parameters.</p>
<h2 id="parameters"><a href="#parameters" class="headerlink" title="parameters"></a>parameters</h2><p>Argument is where the initial value is from, and parameter is used to pass value&#x2F;references to methods. </p>
<p>Parameter has modifier (e.g. out, final, this, params) and type</p>
<p>Argument are passed as parameter in 4 ways:</p>
<h3 id="value-parameter"><a href="#value-parameter" class="headerlink" title="value parameter:"></a>value parameter:</h3><p>parameter change won’t affect the argument</p>
<ol>
<li>only for input parameter passing</li>
<li>optional by specify default value</li>
</ol>
<h3 id="reference-parameter"><a href="#reference-parameter" class="headerlink" title="reference parameter"></a>reference parameter</h3><p>parameter change will affect the argument</p>
<ol>
<li>for input&#x2F;output parameter passing</li>
</ol>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">swap</span>(<span class="params"><span class="keyword">ref</span> <span class="built_in">int</span> x, <span class="keyword">ref</span> <span class="built_in">int</span> y</span>)</span></span><br></pre></td></tr></table></figure>

<h3 id="output-parameter"><a href="#output-parameter" class="headerlink" title="output parameter"></a>output parameter</h3><p>similar to reference parameter except for that the initial value is unimportant.</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">divide</span>(<span class="params"><span class="built_in">int</span> x, <span class="built_in">int</span> y, <span class="keyword">out</span> <span class="built_in">int</span> res, <span class="keyword">out</span> <span class="built_in">int</span> remainder</span>)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">divide(<span class="number">1</span>,<span class="number">2</span>,<span class="keyword">out</span> <span class="keyword">var</span> res, <span class="keyword">out</span> <span class="keyword">var</span> remainder);</span><br></pre></td></tr></table></figure>

<h3 id="parameter-arrays"><a href="#parameter-arrays" class="headerlink" title="parameter arrays"></a>parameter arrays</h3><p>similar to java <code>…</code></p>
<h2 id="extension-methods"><a href="#extension-methods" class="headerlink" title="extension methods"></a>extension methods</h2><p><a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/extension-methods">extension method</a> is a mechanism that you can “add method” to a class without extending from it.</p>
<p>This method:</p>
<ol>
<li>must be static</li>
<li>works in scope when you explictly import the namespace into you source code with a <code>using</code> directive.</li>
<li>must be the first param of method.</li>
<li>when used, it’s same as the normal instance method.</li>
</ol>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">ExtensionMethods</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">MyExtensions</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">WordCount</span>(<span class="params"><span class="keyword">this</span> String str</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> str.Split(<span class="keyword">new</span> <span class="built_in">char</span>[] &#123; <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;?&#x27;</span> &#125;, </span><br><span class="line">                             StringSplitOptions.RemoveEmptyEntries).Length;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://hfcherish.github.io/2019/03/26/python-basic/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Cherish">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cherish's Blog">
      <meta itemprop="description" content="从心所欲不逾矩">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Cherish's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/03/26/python-basic/" class="post-title-link" itemprop="url">python basic</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-03-26 12:43:42" itemprop="dateCreated datePublished" datetime="2019-03-26T12:43:42+08:00">2019-03-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-10-24 13:22:27" itemprop="dateModified" datetime="2022-10-24T13:22:27+08:00">2022-10-24</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="WORDS">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">WORDS:</span>
      <span>0</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a href="https://www.sololearn.com/play/python">great free learning website with quiz</a></p>
<p><a href="http://pythontutor.com/live.html#mode=edit">great online editor &amp; debugger</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/41381773">Python学习资料&#x2F;文章&#x2F;指南整理</a></p>
<h1 id="Zen-of-Python"><a href="#Zen-of-Python" class="headerlink" title="Zen of Python"></a>Zen of Python</h1><p>By typing <code>import this</code>, you can see the zen of python. Some need more explanation:</p>
<p>Explicit is better than implicit: It is best to spell out exactly what your code is doing. This is why adding a numeric string to an integer requires explicit conversion, rather than having it happen behind the scenes, as it does in other languages.<br>Flat is better than nested: Heavily nested structures (lists of lists, of lists, and on and on…) should be avoided.<br>Errors should never pass silently: In general, when an error occurs, you should output some sort of error message, rather than ignoring it.</p>
<h2 id="PEP"><a href="#PEP" class="headerlink" title="PEP"></a>PEP</h2><p><strong>Python Enhancement Proposals (PEP)</strong> are suggestions for improvements to the language, made by experienced Python developers.</p>
<p><strong>PEP 8</strong> is a style guide on the subject of writing readable code<br><strong>PEP 20</strong>: The Zen of Python<br><strong>PEP 257</strong>: Style Conventions for Docstrings</p>
<h3 id="Naming-conventions"><a href="#Naming-conventions" class="headerlink" title="Naming conventions"></a>Naming conventions</h3><p><strong>PEP 8</strong> is a style guide on the subject of writing readable code. It contains a number of guidelines in reference to variable names, which are summarized here:<br>- modules should have short, all-lowercase names;<br>- class names should be in the CapWords style;<br>- most variables and function names should be lowercase_with_underscores;<br>- constants (variables that never change value) should be CAPS_WITH_UNDERSCORES;<br>- names that would clash with Python keywords (such as ‘class’ or ‘if’) should have a trailing underscore.</p>
<h1 id="install"><a href="#install" class="headerlink" title="install"></a>install</h1><h2 id="Brew-install"><a href="#Brew-install" class="headerlink" title="Brew install"></a>Brew install</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ brew install python</span><br></pre></td></tr></table></figure>

<h2 id="install-multiple-version"><a href="#install-multiple-version" class="headerlink" title="install multiple version"></a>install multiple version</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># use pyenv to install multiple version</span></span><br><span class="line">$ brew update</span><br><span class="line">$ brew install pyenv</span><br><span class="line"></span><br><span class="line"><span class="comment"># Clone the repository to to get the latest version of pyenv</span></span><br><span class="line">$ git <span class="built_in">clone</span> https://github.com/pyenv/pyenv.git ~/.pyenv</span><br><span class="line"></span><br><span class="line"><span class="comment"># define envs</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">&#x27;export PYENV_ROOT=&quot;$HOME/.pyenv&quot;&#x27;</span> &gt;&gt; ~/.zshrc</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">&#x27;export PATH=&quot;$PYENV_ROOT/bin:$PATH&quot;&#x27;</span> &gt;&gt; ~/.zshrc</span><br><span class="line">$ <span class="built_in">source</span> ~/.zshrc</span><br><span class="line"></span><br><span class="line"><span class="comment"># get all versions that can be installed</span></span><br><span class="line">$ pyenv install --list</span><br><span class="line">$ pyenv install 3.7</span><br><span class="line"></span><br><span class="line"><span class="comment"># all current installed</span></span><br><span class="line">$ pyenv versions</span><br><span class="line"><span class="comment"># current active</span></span><br><span class="line">$ pyenv version</span><br><span class="line"></span><br><span class="line"><span class="comment"># set as gloabl version</span></span><br><span class="line">$ pyenv global 3.7</span><br><span class="line"><span class="comment"># set a local version </span></span><br><span class="line"><span class="comment"># This command creates a .python-version file in your current directory. If you have pyenv active in your environment, this file will automatically activate this version for you.</span></span><br><span class="line">$ pyenv <span class="built_in">local</span> 3.7</span><br><span class="line"><span class="comment"># set as shell version</span></span><br><span class="line"><span class="comment"># This command activates the version specified by setting the PYENV_VERSION environment variable. This command overwrites any applications or global settings you may have. If you want to deactivate the version, you can use the --unset flag.</span></span><br><span class="line">$ pyenv shell 3.7</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># check the version</span></span><br><span class="line">$ python3 --version</span><br><span class="line"></span><br><span class="line"><span class="comment"># add this to ~/.zshrc if the global command not work, to active the pyenv shell features</span></span><br><span class="line">$ <span class="built_in">eval</span> <span class="string">&quot;<span class="subst">$(pyenv init -)</span>&quot;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://files.realpython.com/media/pyenv-pyramid.d2f35a19ded9.png" alt="Pyenv pyramid for order of resolution"></p>
<p>Other pythons installed:</p>
<ul>
<li>&#x2F;usr&#x2F;local&#x2F;bin</li>
<li>&#x2F;usr&#x2F;local&#x2F;Cellar</li>
</ul>
<h1 id="pip"><a href="#pip" class="headerlink" title="pip"></a>pip</h1><p><a href="https://pypi.org/project/pip/">pip</a> is the package installer for python.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip install package-name</span><br></pre></td></tr></table></figure>

<p>On windows, to use <code>pip</code> after python installation, you need to config both the python &amp; pip path.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:c/users/xiaoming/AppData/Programs/Python/Python37:c/users/xiaoming/AppData/Programs/Python/Python37/Scripts</span><br></pre></td></tr></table></figure>

<h2 id="common-used-commands"><a href="#common-used-commands" class="headerlink" title="common used commands"></a>common used commands</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># list all installed packages</span></span><br><span class="line">$ pip freeze</span><br><span class="line"></span><br><span class="line"><span class="comment"># downgrade pip</span></span><br><span class="line">$ python -m install pip=20.2.4</span><br><span class="line"><span class="comment"># upgrade pip</span></span><br><span class="line">$ python -m pip install --upgrade pip</span><br></pre></td></tr></table></figure>

<h1 id="Packaging"><a href="#Packaging" class="headerlink" title="Packaging"></a>Packaging</h1><p>In Python, the term <strong>packaging</strong> refers to putting modules you have written in a standard format, so that other programmers can install and use them with ease.<br>This involves use of the modules <strong>setuptools</strong> and <strong>distutils</strong>.</p>
<ol>
<li><p>organize existing files correctly. Place all of the files you want to put in a library in the same parent directory. This directory should also contain a file called <strong>_<em>init</em>_.py</strong>, which can be blank but must be present in the directory. <code>__init__.py</code> turns a directory to a module.<br>This directory goes into another directory containing the readme and license, as well as an important file called <strong>setup.py</strong>.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SoloLearn/</span><br><span class="line"> LICENSE.txt</span><br><span class="line"> README.txt</span><br><span class="line"> setup.py</span><br><span class="line"> sololearn/</span><br><span class="line">    __init__.py</span><br><span class="line">    sololearn.py</span><br><span class="line">    sololearn2.py</span><br></pre></td></tr></table></figure>
</li>
<li><p>Write the <strong>setup.py</strong> file. This contains information necessary to assemble the package so it can be uploaded to <strong>PyPI</strong> and installed with <strong>pip</strong> (name, version, etc.).</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> setup(</span><br><span class="line">   name=<span class="string">&#x27;SoloLearn&#x27;</span>, </span><br><span class="line">   version=<span class="string">&#x27;0.1dev&#x27;</span>,</span><br><span class="line">   packages=[<span class="string">&#x27;sololearn&#x27;</span>,],</span><br><span class="line">   license=<span class="string">&#x27;MIT&#x27;</span>, </span><br><span class="line">   long_description=<span class="built_in">open</span>(<span class="string">&#x27;README.txt&#x27;</span>).read(),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Write Other Files   </p>
</li>
<li><p>Build a source distribution, use the command line to navigate to the directory containing setup.py, and run the command <code>python setup.py sdist</code>.</p>
<ol>
<li>Run <code>python setup.py bdist</code> or, for Windows, <code>python setup.py bdist_wininst</code> to build a binary distribution.</li>
</ol>
</li>
<li><p>Upload the package to <strong>PyPI</strong>. Use <code>python setup.py register</code>, followed by <code>python setup.py sdist upload</code> to upload a package.</p>
</li>
<li><p>install a package with <code>python setup.py install</code>.</p>
</li>
</ol>
<h2 id="init-py"><a href="#init-py" class="headerlink" title="_init_.py"></a>_<em>init</em>_.py</h2><p><a href="https://www.cnblogs.com/Lands-ljk/p/5880483.html">Python <strong>init</strong>.py 作用详解</a></p>
<p><code>__init__.py</code> 文件的作用是将文件夹变为一个Python模块,Python 中的每个模块的包中，都有<code>__init__.py</code> 文件。</p>
<p>通常<code>__init__.py</code> 文件为空，但是我们还可以为它增加其他的功能。我们在导入一个包时，实际上是导入了它的<code>__init__.py</code>文件。这样我们可以在<code>__init__.py</code>文件中批量导入我们所需要的模块，而不再需要一个一个的导入。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># package</span><br><span class="line"># __init__.py</span><br><span class="line">import re</span><br><span class="line">import urllib</span><br><span class="line">import sys</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line"># a.py</span><br><span class="line">import package </span><br><span class="line">print(package.re, package.urllib, package.sys, package.os)</span><br></pre></td></tr></table></figure>

<p>注意这里访问<code>__init__.py</code>文件中的引用文件，需要加上包名。</p>
<p><code>__init__.py</code>中还有一个重要的变量，<code>__all__</code>, 它用来将模块全部导入。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># __init__.py</span><br><span class="line">__all__ = [&#x27;os&#x27;, &#x27;sys&#x27;, &#x27;re&#x27;, &#x27;urllib&#x27;]</span><br><span class="line"></span><br><span class="line"># a.py</span><br><span class="line">from package import *</span><br></pre></td></tr></table></figure>

<p>这时就会把注册在<code>__init__.py</code>文件中<code>__all__</code>列表中的模块和包导入到当前文件中来。</p>
<p>可以了解到，<code>__init__.py</code>主要控制包的导入行为。</p>
<h2 id="setup-py"><a href="#setup-py" class="headerlink" title="setup.py"></a>setup.py</h2><p><a href="https://setuptools.readthedocs.io/en/latest/">setuptools</a> is the packaging tool for python (like maven&#x2F;gradle for java?)</p>
<p>When coding in local, you can use <code>pip install</code> to install dependency. However, when deploy a python project, you need to package all dependency, modules into one project. You need <code>setup.py</code>.</p>
<p>When organize python in modules, you need to know and import the function in other modules. In compilation stage, you need to feel the other modules&amp;packages. <code>setup.py</code> does the magic. (This is my guess)</p>
<h2 id="Packaging-for-users"><a href="#Packaging-for-users" class="headerlink" title="Packaging for users"></a>Packaging for users</h2><p>For normal users who don’t have python on computer, we need to convert scripts to executables for them.</p>
<p>For Windows, <strong>py2exe</strong> or <strong>PyInstaller</strong> or <strong>cx_Freeze</strong> can be used to package a Python script, along with the libraries it requires, into a single executable.<br>For Macs, use <strong>py2app</strong>, <strong>PyInstaller</strong> or <strong>cx_Freeze</strong>.</p>
<h1 id="Some-special-grammars"><a href="#Some-special-grammars" class="headerlink" title="Some special grammars"></a>Some special grammars</h1><h2 id="if-name-x3D-x3D-‘-main-’"><a href="#if-name-x3D-x3D-‘-main-’" class="headerlink" title="if _name_ &#x3D;&#x3D; ‘__main__’"></a>if _<em>name</em>_ &#x3D;&#x3D; ‘__main__’</h2><p><a href="https://blog.csdn.net/yjk13703623757/article/details/77918633">如何简单地理解Python中的if _<em>name</em>_ &#x3D;&#x3D; ‘__main__’</a></p>
<p>If you are <code>test.py</code>, then other module knows you as <code>__name__==&#39;test&#39;</code>, and you know yourself as <code>__name==&#39;__main__&#39;</code>.</p>
<p>The code block in <code>if __name__ == &#39;__main__&#39;</code> will only be executed when the file is executed directly. If other module import <code>test.py</code> as module, the code block won’t be executed.</p>
<p>It’s kind of like main function in java&#x2F;c, but with big difference. Python is <strong>a script language</strong> — interpretive execution, which can be run without any so-called main entry. You don’t need to make <code>test.py</code> runnable by providing <code>main</code>, but you can provide <code>if __name__ == &#39;__main__&#39;</code> if you want this block only executed when called directly rather than as module.</p>
<h2 id="else"><a href="#else" class="headerlink" title="else"></a>else</h2><p>The <strong>else</strong> statement can be used in:</p>
<ul>
<li>the <strong>if</strong> statement</li>
<li>a <strong>for</strong> or <strong>while</strong> loop, the code within it is called if the loop finishes normally &#x2F; completely (when a <strong>break</strong> statement does not cause an exit from the loop).</li>
<li>the <strong>try&#x2F;except</strong> statements, the code within it is only executed if no error occurs in the <strong>try</strong> statement.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">if_else</span>(<span class="params">a</span>):</span><br><span class="line">  <span class="keyword">if</span> a == <span class="string">&#x27;if&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;this is in if&#x27;</span>)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;this is not if!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">for_else</span>():</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">if</span> i &gt; <span class="number">2</span>:</span><br><span class="line">      <span class="comment"># print(&#x27;Will get here. The else won\&#x27;t be executed&#x27;)</span></span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;first for finish completely&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">if</span> i &gt; <span class="number">10</span>:</span><br><span class="line">      <span class="comment"># print(&#x27;Never get here. The else will be executed&#x27;)</span></span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;second for finish completely&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">try_else</span>():</span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="number">5</span>/<span class="number">0</span>)</span><br><span class="line">  <span class="keyword">except</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;there is exception, the first else won\&#x27;t be executed&#x27;</span>)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;first try finished successfully&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="number">5</span>/<span class="number">1</span>)</span><br><span class="line">  <span class="keyword">except</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;there is no exception, the else will be executed&#x27;</span>)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;second try finished successfully&#x27;</span>)</span><br><span class="line"></span><br><span class="line">if_else(<span class="string">&#x27;not_if&#x27;</span>) <span class="comment"># this is not if!</span></span><br><span class="line">for_else() <span class="comment"># second for finish completely</span></span><br><span class="line">try_else()</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">there is exception, the first else won&#x27;t be executed</span></span><br><span class="line"><span class="string">5.0</span></span><br><span class="line"><span class="string">second try finished successfully</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h1 id="class"><a href="#class" class="headerlink" title="class"></a>class</h1><p>Classes are created using the keyword <strong>class</strong> and an indented block, which contains class <strong>methods</strong> (which are functions). All methods must have <strong>self</strong> as their first parameter, you do not need to include it when you call the methods. Within a method definition, <strong>self</strong> refers to the instance calling the method.</p>
<p>To inherit a class from another class, put the superclass name in parentheses after the class name.</p>
<p>Classes can also have <strong>class attributes</strong>, created by assigning variables within the body of the class. These can be accessed either from instances of the class, or the class itself.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Animal</span>:</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, color</span>):</span><br><span class="line">    self.name = name</span><br><span class="line">    self.color = color</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">shout</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;ha&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span>(<span class="title class_ inherited__">Animal</span>):</span><br><span class="line">  legs = <span class="number">4</span>    <span class="comment"># the class attribute</span></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">shout</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;wong&#x27;</span>)</span><br><span class="line">    <span class="built_in">super</span>().shout()    <span class="comment"># call super method</span></span><br><span class="line"></span><br><span class="line">Dog.legs    <span class="comment"># 4</span></span><br><span class="line">d = Dog(<span class="string">&#x27;heidou&#x27;</span>, <span class="string">&#x27;black&#x27;</span>)</span><br><span class="line">d.legs    <span class="comment"># 4</span></span><br><span class="line">d.name     <span class="comment"># &#x27;heidou&#x27;</span></span><br><span class="line">d.shout()    </span><br><span class="line"><span class="comment"># wong</span></span><br><span class="line"><span class="comment"># ha</span></span><br></pre></td></tr></table></figure>

<h2 id="new-vs-init"><a href="#new-vs-init" class="headerlink" title="__new__ vs __init__"></a><code>__new__</code> vs <code>__init__</code></h2><p><a href="https://www.agiliq.com/blog/2012/06/__new__-python/">_<em>new</em>_ in python</a></p>
<p>_<em>new</em>_ is a static method which creates an instance. It allocates memory for an object. __init__ initialize the value of the object (instance). <code>__new__</code> is rarely overriden.</p>
<p>When you are instantiate an instance by calling the class, the <code>__new__</code> gets called first to create the object in memory, and then <code>__init__</code> is called to initialize it.</p>
<p>_<em>new</em>_ must return the created object. Only when <code>__new__</code> returns the created instance then <code>__init__</code> gets called. If <code>__new__</code> does not return an instance then <code>__init__</code> would not be called.</p>
<p>The <code>__new__</code> definition:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__new__(cls, *args, **kwargs)    </span><br></pre></td></tr></table></figure>

<p>An example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime <span class="keyword">as</span> dt</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__new__</span>(<span class="params">cls, *args, **kwargs</span>):</span><br><span class="line">    <span class="built_in">print</span>(cls)</span><br><span class="line">    <span class="built_in">print</span>(args)</span><br><span class="line">    <span class="built_in">print</span>(kwargs)</span><br><span class="line">    obj = <span class="built_in">object</span>.__new__(cls)</span><br><span class="line">    <span class="built_in">setattr</span>(obj, <span class="string">&#x27;created_at&#x27;</span>, dt.datetime.now())</span><br><span class="line">    <span class="keyword">return</span> obj <span class="comment"># if no return here, __init__ won&#x27;t be called later</span></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, a, named</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;in init&#x27;</span>)</span><br><span class="line">    self.a = a</span><br><span class="line">    self.b = named</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;a=&#123;0&#125;, b=&#123;1&#125;, created_at: &#123;2&#125;&#x27;</span>.<span class="built_in">format</span>(self.a, self.b, self.created_at)</span><br><span class="line"></span><br><span class="line">a = A(<span class="number">1</span>, named=<span class="number">2</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;class &#x27;__main__.A&#x27;&gt;</span></span><br><span class="line"><span class="string">(1,)</span></span><br><span class="line"><span class="string">&#123;&#x27;named&#x27;: 2&#125;</span></span><br><span class="line"><span class="string">in init</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(a) <span class="comment"># a=1, b=2, created_at: 2020-10-19 15:22:19.558501</span></span><br></pre></td></tr></table></figure>

<h2 id="del"><a href="#del" class="headerlink" title="__del__"></a><code>__del__</code></h2><p>Destruction of an object occurs when its <strong>reference count</strong> reaches zero.</p>
<p>The <strong>del</strong> statement reduces the reference count of an object by one, and this often leads to its deletion.<br>The magic method for the <strong>del</strong> statement is <code>__del__</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">5</span></span><br><span class="line"><span class="keyword">del</span> a</span><br></pre></td></tr></table></figure>

<h2 id="private"><a href="#private" class="headerlink" title="private"></a>private</h2><p>The Python philosophy is often stated as <strong>“we are all consenting adults here”</strong>, meaning that you shouldn’t put arbitrary restrictions on accessing parts of a class. Hence there are no ways of enforcing a method or attribute be strictly private. However, there are ways to discourage people from accessing parts of a class, such as by denoting that it is an implementation detail, and should be used at their own risk.</p>
<p>Weakly private methods and attributes have a <strong>single underscore</strong> at the beginning. This signals that they are private, and <strong>shouldn’t be</strong> used by external code. Its only actual effect is that <strong>from module_name import *</strong> won’t import variables that start with a single underscore.</p>
<p>Strongly private methods and attributes have a <strong>double underscore</strong> at the beginning of their names. This causes their names to be mangled, which means that they can’t be accessed from outside the class by the name. The purpose of this isn’t to ensure that they are kept private, but to avoid bugs if there are subclasses that have methods or attributes with the same names. Basically, Python protects those members by internally changing the name to include the class name.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">  __egg = <span class="number">7</span></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, a</span>):</span><br><span class="line">    self.__a = a</span><br><span class="line"></span><br><span class="line">A._A__egg <span class="comment"># 7</span></span><br><span class="line">a = A(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">a._A__a <span class="comment"># &#x27;a&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="class-methods-vs-instance-methods-vs-static-methods"><a href="#class-methods-vs-instance-methods-vs-static-methods" class="headerlink" title="class methods vs instance methods vs static methods"></a>class methods vs instance methods vs static methods</h2><p><strong>Instance methods</strong> are called by a instance, which is passed to the <strong>self</strong> parameter of the method.</p>
<p><strong>Class methods</strong> are called by a class, which is passed to the <strong>cls</strong> parameter of the method.<br>A common use of these are factory methods, which instantiate an instance of a class, using different parameters than those usually passed to the class constructor.<br>Class methods are marked with a <strong>classmethod decorator</strong>.</p>
<p><strong>Static methods</strong> are similar to class methods, except they don’t receive any additional arguments; they are identical to normal functions that belong to a class.<br>They are marked with the <strong>staticmethod</strong> decorator.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Rectangle</span>:</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, a, b</span>):</span><br><span class="line">    self.a = a</span><br><span class="line">    self.b = b</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">area</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="built_in">print</span>(self.a * self.b)</span><br><span class="line"><span class="meta">  @classmethod</span></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">new_square</span>(<span class="params">cls, a</span>):</span><br><span class="line">    <span class="keyword">return</span> cls(a, a)</span><br><span class="line"><span class="meta">  @staticmethod</span></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">validate_int</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">isinstance</span>(a, <span class="built_in">int</span>), <span class="string">&#x27;must be int&#x27;</span></span><br><span class="line"></span><br><span class="line">r = Rectangle(<span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line">r.area() <span class="comment"># 20</span></span><br><span class="line">s = Rectangle.new_square(<span class="number">4</span>)</span><br><span class="line">s.area() <span class="comment"># 16</span></span><br><span class="line">Rectangle.validate_int(<span class="string">&#x27;fd&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="Properties"><a href="#Properties" class="headerlink" title="Properties"></a>Properties</h2><p><strong>Properties</strong> are created by putting the <strong>property</strong> decorator above a method, which means when the instance attribute with the same name as the method is accessed, the method will be called instead.<br>One common use of a property is to make an attribute <strong>read-only</strong>.</p>
<p>Properties can also be set by defining <strong>setter&#x2F;getter</strong> functions.<br>The <strong>setter</strong> function sets the corresponding property’s value. To define a <strong>setter</strong>, you need to use a decorator of the same name as the property, followed by a dot and the <strong>setter</strong> keyword.</p>
<p>​&#96;&#96;&#96;python<br>class Pizza:<br>  def <strong>init</strong>(self, a):<br>    self._a &#x3D; a<br>  @property<br>  def a_list(self):<br>    return [self._a] * 10<br>  @a_list.setter<br>  def a_list(self, value):<br>    self._a &#x3D; value[0]</p>
<p>p &#x3D; Pizza(7)<br>p.a_list # [7, 7, 7, 7, 7, 7, 7, 7, 7, 7]<br>p.a_list &#x3D; [1]<br>p.a_list # [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">## Magic Methods</span><br><span class="line"></span><br><span class="line">**Magic methods** are special methods which have **double underscores** at the beginning and end of their names. They are used to create functionality that can&#x27;t be represented as a normal method.</span><br><span class="line"></span><br><span class="line">`__init__` is the constructor.</span><br><span class="line"></span><br><span class="line">Magic methods for common operators (operator overload):</span><br><span class="line"></span><br><span class="line">`__add__` for -</span><br><span class="line">`__sub__` for -</span><br><span class="line">`__mul__` for *</span><br><span class="line">`__truediv__` for /</span><br><span class="line">`__floordiv__` for //</span><br><span class="line">`__mod__` for %</span><br><span class="line">`__pow__` for **</span><br><span class="line">`__and__` for &amp;</span><br><span class="line">`__xor__` for ^</span><br><span class="line">`__or__` for |</span><br><span class="line"></span><br><span class="line">Magic methods for comparisons (If `__ne__` is not implemented, it returns the opposite of `__eq__`):</span><br><span class="line"></span><br><span class="line">`__lt__` for &lt;</span><br><span class="line">`__le__` for &lt;=</span><br><span class="line">`__eq__` for ==</span><br><span class="line">`__ne__` for !=</span><br><span class="line">`__gt__` for &gt;</span><br><span class="line">`__ge__` for &gt;=</span><br><span class="line"></span><br><span class="line">Magic methods for making classes act like containers:</span><br><span class="line">`__len__` for len()</span><br><span class="line">`__getitem__` for indexing</span><br><span class="line">`__setitem__` for assigning to indexed values</span><br><span class="line">`__delitem__` for deleting indexed values</span><br><span class="line">`__iter__` for iteration over objects (e.g., in for loops)</span><br><span class="line">`__contains__` for in</span><br><span class="line"></span><br><span class="line">Magic methods for converting objects to built-in types:</span><br><span class="line">`__int__` for int()</span><br><span class="line">`__str__` for str()</span><br><span class="line"></span><br><span class="line">### `r` methods&lt;a name = &quot;r-methods&quot; /&gt;</span><br><span class="line"></span><br><span class="line">There are equivalent **r** methods for all magic methods that overloads operators. For example, the expression **x + y** is translated into **x.__add__(y)**. However, if x hasn&#x27;t implemented __add__, and x and y are of different types, then **y.__radd__(x)** is called.</span><br><span class="line"></span><br><span class="line">&quot;r&quot; stands for &quot;right&quot;, meaning that the operator passed is on the right. If the conversion of the 1st type to the 2nd isn&#x27;t supported, it simply tries calling the inverse one (2nd conversion to the 1st) for the other type.</span><br><span class="line"></span><br><span class="line">**r** methods can be used when you want to overload operator between a thirt lib type and your type. Since you may not modify the third library, you can add the reverse **r** method in your type.</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">class PairNumber:</span><br><span class="line">def __init__(self, n1, n2):</span><br><span class="line">  self.n1 = n1</span><br><span class="line">  self.n2 = n2</span><br><span class="line">def __floordiv__(self, other):</span><br><span class="line">  return PairNumber(self.n1//other.n1, self.n2 // other.n2)</span><br><span class="line">def __rtruediv__(self, other):</span><br><span class="line">  return PairNumber(other/self.n1, other/self.n2)</span><br><span class="line">def __repr__(self):</span><br><span class="line">  return &#x27;PairNumber&#123;0&#125;&#x27;.format((self.n1, self.n2))</span><br><span class="line">def __str__(self):</span><br><span class="line">  return str((self.n1, self.n2))</span><br><span class="line"></span><br><span class="line">class IntPairNumber(PairNumber):</span><br><span class="line">def __int__(self):</span><br><span class="line">  return self.n1 + self.n2</span><br><span class="line"></span><br><span class="line">p1 = IntPairNumber(4, 10)</span><br><span class="line">p2 = IntPairNumber(3, 19)</span><br><span class="line">p1 // p2 # PairNumber(1, 0)</span><br><span class="line">print(p1 // p2) # (1, 0)</span><br><span class="line">str(2 / p1)        # PairNumber(0.5, 0.2)</span><br><span class="line">int(p1)                # 14</span><br></pre></td></tr></table></figure>

<h3 id="call-method"><a href="#call-method" class="headerlink" title="__call__ method"></a><code>__call__</code> method</h3><p><code>__call__</code> method can call an object as a function. Thus you can transfer the object as a func parameter in a function.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PairNumber</span>:</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, n1, n2</span>):</span><br><span class="line">    self.n1 = n1</span><br><span class="line">    self.n2 = n2</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self, other</span>):</span><br><span class="line">    <span class="keyword">return</span> self.n1 + self.n2 + other</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">addTwice</span>(<span class="params">func, other</span>):</span><br><span class="line">  <span class="keyword">return</span> func(other) + other</span><br><span class="line"></span><br><span class="line">p1 = PairNumber(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">p1(<span class="number">4</span>)        <span class="comment"># 7</span></span><br><span class="line">addTwice(p1, <span class="number">4</span>)    <span class="comment"># 11</span></span><br></pre></td></tr></table></figure>

<h3 id="str-vs-repr"><a href="#str-vs-repr" class="headerlink" title="__str__ vs __repr__"></a><code>__str__</code> vs <code>__repr__</code></h3><p>In short, the goal of <code>__repr__</code> is to be unambiguous and <code>__str__</code> is to be readable. If <code>__repr__</code> is defined, and <code>__str__</code> is not, the object will behave as though <code>__str__=__repr__</code>.</p>
<p>The commandline will show the content in <code>__repr__</code> when you simply type the object. And when print(some_obj), it will show the content in <code>__str__</code> of that object. So many would say: <code>__repr__</code> is for developers, <code>__str__</code> is for customers. e.g. obj &#x3D; uuid.uuid1(), obj._<em>str__() is “2d7fc7f0-7706-11e9-94ae-0242ac110002” and obj.__repr</em>_() is “UUID(‘2d7fc7f0-7706-11e9-94ae-0242ac110002’)”.</p>
<p><strong>To sum up</strong>: implement <code>__repr__</code> for any class you implement. This should be second nature. Implement <code>__str__</code> if you think it would be useful to have a string version which errs on the side of readability.</p>
<p>See example in <a href="#r-methods">r <strong>method</strong></a></p>
<h1 id="Opening-Files"><a href="#Opening-Files" class="headerlink" title="Opening Files"></a>Opening Files</h1><p>You can specify the <strong>mode</strong> used to open a file by applying a second argument to the <strong>open</strong> function.<br>Sending “r” means open in read mode, which is the default.<br>Sending “w” means write mode, for <em><strong>rewriting</strong></em> the contents of a file.<br>Sending “a” means append mode, for adding new content to the end of the file.</p>
<p>Adding “b” to a mode opens it in <strong>binary</strong> mode, which is used for non-text files (such as image and sound files).<br><strong>For example:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># write mode</span></span><br><span class="line"><span class="built_in">open</span>(<span class="string">&quot;filename.txt&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># read mode</span></span><br><span class="line"><span class="built_in">open</span>(<span class="string">&quot;filename.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line"><span class="built_in">open</span>(<span class="string">&quot;filename.txt&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># binary write mode</span></span><br><span class="line"><span class="built_in">open</span>(<span class="string">&quot;filename.txt&quot;</span>, <span class="string">&quot;wb&quot;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>You can use the + sign with each of the modes above to give them extra access to files. For example, r+ opens the file for both reading and writing.</p>
<p>Use <code>help(open)</code> to see the complete file modes supported.</p>
</blockquote>
<ul>
<li><p>“r”<br>Read from file - YES<br>Write to file - NO<br><strong>Create file if not exists - NO</strong><br>Truncate file to zero length - NO<br>Cursor position - BEGINNING</p>
</li>
<li><p>“r+”  &#x3D;&#x3D;&#x3D;&#x3D;&gt; Opens a file for both reading and writing (write from the current cursor, that is, if you already call <code>file.read()</code>, then it means cursor is already at the end, then the writing is appending. However, if you start with <code>file.write()</code>, the cursor is at the beginning, thus it will <em><strong>rewrite</strong></em> from the beginning)<br>Read from file - YES<br>Write to file - YES<br><strong>Create file if not exists - NO</strong><br><strong>Truncate file to zero length - NO</strong><br>Cursor position - BEGINNING</p>
</li>
<li><p>“w”<br>Read from file - NO<br>Write to file - YES<br><strong>Create file if not exists - YES</strong><br><strong>Truncate file to zero length - YES</strong><br>Cursor position - BEGINNING</p>
</li>
<li><p>“w+” &#x3D;&#x3D;&#x3D;&gt; Opens a file for both writing and reading<br>Read from file - YES<br>Write to file - YES<br><strong>Create file if not exists - YES</strong><br><strong>Truncate file to zero length - YES</strong><br>Cursor position - BEGINNING</p>
</li>
<li><p>“a”<br>Read from file - NO<br>Write to file - YES<br><strong>Create file if not exists - YES</strong><br><strong>Truncate file to zero length - NO</strong><br>Cursor position - END</p>
</li>
<li><p>“a+” &#x3D;&#x3D;&#x3D;&gt; Opens a file for both appending and reading<br>Read from file - YES<br>Write to file - YES<br><strong>Create file if not exists - YES</strong><br><strong>Truncate file to zero length - NO</strong><br>Cursor position - END</p>
</li>
</ul>
<h1 id="Iterable-containers"><a href="#Iterable-containers" class="headerlink" title="Iterable containers"></a>Iterable containers</h1><h2 id="List-x2F-string-x2F-tuple-slicing"><a href="#List-x2F-string-x2F-tuple-slicing" class="headerlink" title="List&#x2F;string&#x2F;tuple slicing"></a>List&#x2F;string&#x2F;tuple slicing</h2><p>slice can have 3 parameters:</p>
<ol>
<li>Start index (included, count from end of the list if negative, default as 0)</li>
<li>End index (excluded, count from end of the list if negative, default as end of the list)</li>
<li>Step</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>    = <span class="string">&#x27;0123456&#x27;</span></span><br><span class="line">tp = <span class="built_in">tuple</span>(<span class="built_in">str</span>)    <span class="comment"># (&#x27;0&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;5&#x27;, &#x27;6&#x27;)</span></span><br><span class="line">lst = <span class="built_in">list</span>(<span class="built_in">str</span>) <span class="comment"># [&#x27;0&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;5&#x27;, &#x27;6&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># get first 2</span></span><br><span class="line"><span class="built_in">str</span>[:<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># get last 2</span></span><br><span class="line"><span class="built_in">str</span>[<span class="number">5</span>:]</span><br><span class="line"><span class="built_in">str</span>[-<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line"><span class="comment"># get odd number (the third number is the step)</span></span><br><span class="line"><span class="built_in">str</span>[<span class="number">1</span>::<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># reverse</span></span><br><span class="line"><span class="built_in">str</span>[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># get the 3 number from 1(included) and reverse it</span></span><br><span class="line"><span class="built_in">str</span>[<span class="number">3</span>:<span class="number">0</span>:-<span class="number">1</span>]</span><br></pre></td></tr></table></figure>

<h2 id="List-Comprehensions"><a href="#List-Comprehensions" class="headerlink" title="List Comprehensions"></a>List Comprehensions</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cubes = [i**<span class="number">3</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]    <span class="comment"># [0, 1, 8, 27, 64]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># with if statement</span></span><br><span class="line">evenSquares = [i**<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>) <span class="keyword">if</span> i ** <span class="number">2</span> % <span class="number">2</span> == <span class="number">0</span>] <span class="comment"># [0, 4, 16]</span></span><br><span class="line">evenSquares = [i**<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">5</span>,<span class="number">2</span>)] <span class="comment"># [0, 4, 16]</span></span><br><span class="line">evens =  [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>) <span class="keyword">if</span> i%<span class="number">2</span> == <span class="number">0</span>] <span class="comment"># [0, 2, 4]</span></span><br></pre></td></tr></table></figure>

<h3 id="all-amp-any"><a href="#all-amp-any" class="headerlink" title="all &amp; any"></a>all &amp; any</h3><p>use all() &#x2F; any() to check a list of bool.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">nums = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">all</span>([i &gt; <span class="number">5</span> <span class="keyword">for</span> i <span class="keyword">in</span> nums]):</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;All larger than 5&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">any</span>([i % <span class="number">2</span> == <span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> nums]):</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;At least one is even&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="Tuple"><a href="#Tuple" class="headerlink" title="Tuple"></a>Tuple</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># define a tuple</span></span><br><span class="line">t1 = <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span></span><br><span class="line">t2 = (<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">t1 == t2 <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># unpack a tuple</span></span><br><span class="line">a,b,*c,d = <span class="built_in">range</span>(<span class="number">10</span>)</span><br><span class="line">a <span class="comment"># 0</span></span><br><span class="line">b <span class="comment"># 1</span></span><br><span class="line">c <span class="comment"># [2,3,4,5,6,7,8]</span></span><br><span class="line">d <span class="comment"># 9</span></span><br></pre></td></tr></table></figure>

<h2 id="Generator"><a href="#Generator" class="headerlink" title="Generator"></a>Generator</h2><p><strong>Generators</strong> are a type of iterable, like lists or tuples. Unlike lists, they <strong>don’t allow indexing with arbitrary indices</strong>, but they can still be iterated through with <strong>for</strong> loops.<br>They can be created using functions and the <strong>yield</strong> statement.</p>
<p>Using <strong>generators</strong> results in improved performance, which is the result of the lazy (on demand) generation of values, which translates to lower memory usage. Furthermore, we do not need to wait until all the elements have been generated before we start to use them.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">spell</span>():</span><br><span class="line">  word = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="keyword">for</span> c <span class="keyword">in</span> <span class="string">&#x27;spam&#x27;</span>:</span><br><span class="line">    word += c</span><br><span class="line">    <span class="keyword">yield</span> word</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> w <span class="keyword">in</span> spell():</span><br><span class="line">  <span class="built_in">print</span>(w)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(spell()))    <span class="comment"># to normal list [&#x27;s&#x27;, &#x27;sp&#x27;, &#x27;spa&#x27;, &#x27;spam&#x27;]</span></span><br></pre></td></tr></table></figure>

<h2 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h2><p>Sets can be combined using mathematical operations (list, tuple, dict do not support these operators)<br>The <strong>union</strong> operator <strong>|</strong> combines two sets to form a new one containing items in either.<br>The <strong>intersection</strong> operator <strong>&amp;</strong> gets items only in both.<br>The <strong>difference</strong> operator <strong>-</strong> gets items in the first set but not in the second.<br>The <strong>symmetric difference</strong> operator <strong>^</strong> gets items in either set, but not both.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">s1 = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;</span><br><span class="line">s2 = &#123;<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(s1 | s2) <span class="comment"># union: &#123;1,2,3,4,5,6,7&#125;</span></span><br><span class="line"><span class="built_in">print</span>(s1 &amp; s2) <span class="comment"># intersection: &#123;3,4,5&#125;</span></span><br><span class="line"><span class="built_in">print</span>(s1 - s2) <span class="comment"># in s1 but not s2: &#123;1,2&#125;</span></span><br><span class="line"><span class="built_in">print</span>(s2 - s1) <span class="comment"># in s2 but not s1: &#123;6,7&#125;</span></span><br><span class="line"><span class="built_in">print</span>(s1 ^ s2) <span class="comment"># not in s1 or not in s2: &#123;1,2,6,7&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="String-format"><a href="#String-format" class="headerlink" title="String format"></a>String format</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">####### hello world hello</span></span><br><span class="line"><span class="string">&#x27;&#123;0&#125; &#123;1&#125; &#123;0&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;world&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#123;x&#125; &#123;y&#125; &#123;x&#125;&#x27;</span>.<span class="built_in">format</span>(x=<span class="string">&#x27;hello&#x27;</span>, y=<span class="string">&#x27;world&#x27;</span>)    <span class="comment"># use name</span></span><br><span class="line"></span><br><span class="line"><span class="string">r&#x27;fdjks/fjdkls&#x27;</span> <span class="comment"># r means raw, so you don&#x27;t need to escape any character</span></span><br></pre></td></tr></table></figure>

<h1 id="Functions"><a href="#Functions" class="headerlink" title="Functions"></a>Functions</h1><h2 id="Function-Arguments"><a href="#Function-Arguments" class="headerlink" title="Function Arguments"></a>Function Arguments</h2><p>Using <strong><code>*args</code></strong> as a function parameter enables you to pass an arbitrary number of arguments to that function. The arguments are then accessible as the <strong>tuple</strong> args in the body of the function.</p>
<p>*<strong>*kwargs</strong> (standing for keyword arguments) allows you to handle named arguments that you have not defined in advance. The keyword arguments return a dictionary in which the keys are the argument names, and the values are the argument values.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">some_func</span>(<span class="params">a, some_default=<span class="string">&#x27;this is a default value&#x27;</span>, *args, **kwargs</span>):</span><br><span class="line">  <span class="built_in">print</span>(a)</span><br><span class="line">  <span class="built_in">print</span>(some_default)</span><br><span class="line">  <span class="built_in">print</span>(args)</span><br><span class="line">  <span class="built_in">print</span>(kwargs)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">some_func(<span class="string">&#x27;this is a&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">this is a</span></span><br><span class="line"><span class="string">this is a default value</span></span><br><span class="line"><span class="string">()</span></span><br><span class="line"><span class="string">&#123;&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">some_func(<span class="string">&#x27;this is a&#x27;</span>, <span class="string">&#x27;value rather than default&#x27;</span>, <span class="string">&#x27;first arg&#x27;</span>, <span class="string">&#x27;second arg&#x27;</span>, first_kwarg=<span class="string">&#x27;1&#x27;</span>, second_kwarg=<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">this is a</span></span><br><span class="line"><span class="string">value rather than default</span></span><br><span class="line"><span class="string">(&#x27;first arg&#x27;, &#x27;second arg&#x27;)</span></span><br><span class="line"><span class="string">&#123;&#x27;first_kwarg&#x27;: &#x27;1&#x27;, &#x27;second_kwarg&#x27;: &#x27;2&#x27;&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="Lambda"><a href="#Lambda" class="headerlink" title="Lambda"></a>Lambda</h2><p>A lambda defines an anoymous function. It consists of the <strong>lambda</strong> keyword followed by a list of arguments, a colon, and the <strong>expression</strong> to evaluate and return.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## use named function</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cube</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x ** <span class="number">3</span>    </span><br><span class="line"><span class="built_in">print</span>(cube(<span class="number">3</span>))    <span class="comment"># 27</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## use lambda</span></span><br><span class="line">cube = <span class="keyword">lambda</span> x: x ** <span class="number">3</span></span><br><span class="line"><span class="built_in">print</span>(cube(<span class="number">3</span>))    <span class="comment"># 27</span></span><br></pre></td></tr></table></figure>

<h3 id="Common-used-functors"><a href="#Common-used-functors" class="headerlink" title="Common used functors:"></a>Common used functors:</h3><p>map, filter</p>
<p>module <strong>itertools</strong> is a standard library that contains several functions that are useful in FP.</p>
<p>One type of function it produces is infinite iterators.<br>The function <strong>count</strong> counts up infinitely from a value.<br>The function <strong>cycle</strong> infinitely iterates through an iterable (for instance a list or string).<br>The function <strong>repeat</strong> repeats an object, either infinitely or a specific number of times.<br><strong>takewhile -</strong> takes items from an iterable while a predicate function remains true;<br><strong>chain -</strong> combines several iterables into one long one;<br><strong>accumulate -</strong> returns a running total of values in an iterable.<br><strong>product</strong> - get possible combinations of some iterables<br><strong>permutation</strong> - get permutation of an iterable</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> accumulate, takewhile, product, permutations</span><br><span class="line"></span><br><span class="line">nums = <span class="built_in">list</span>(accumulate(<span class="built_in">range</span>(<span class="number">5</span>)))    <span class="comment"># [0,1,3,6,10]</span></span><br><span class="line"><span class="built_in">list</span>(takewhile(<span class="keyword">lambda</span> x: x &lt;<span class="number">6</span>, nums)) <span class="comment"># [0,1,3]</span></span><br><span class="line"></span><br><span class="line">letters = (<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>)</span><br><span class="line"><span class="built_in">list</span>(product(letters, <span class="built_in">range</span>(<span class="number">2</span>)))    <span class="comment"># [(a,0), (a,1), (b,0), (b,1)] The result is always iterable of tuple</span></span><br><span class="line"><span class="built_in">list</span>(permutations(letters))    <span class="comment"># [(&#x27;a&#x27;, &#x27;b&#x27;), (&#x27;b&#x27;, &#x27;a&#x27;)]</span></span><br></pre></td></tr></table></figure>

<h2 id="Decorator"><a href="#Decorator" class="headerlink" title="Decorator"></a>Decorator</h2><p>Decorators provide a way to modify functions using other functions.</p>
<p>Python provides support to wrap a function in a decorator by pre-pending the function definition with a decorator name and the @ symbol.</p>
<blockquote>
<p>You can use a decorator if you want to modify more than one function in the same way. It’s the common template of multiple functions.</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"></span><br><span class="line"><span class="comment">## define two decorators</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">input_print_deca</span>(<span class="params">func</span>):</span><br><span class="line">  <span class="comment">## this annotation make the callback return the original func&#x27;s name instead of the wrap function&#x27;s name.</span></span><br><span class="line"><span class="meta">  @wraps</span></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">wrap</span>():</span><br><span class="line">    x = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;x: &#x27;</span>))</span><br><span class="line">    y = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;y: &#x27;</span>))</span><br><span class="line">    res = func(x, y)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;the res: &#123;0&#125;&#x27;</span>.<span class="built_in">format</span>(res))</span><br><span class="line">  <span class="keyword">return</span> wrap</span><br><span class="line"></span><br><span class="line"><span class="comment">## use a decorator, and replace the origin method with the decorated one</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x,y</span>):</span><br><span class="line">  <span class="keyword">return</span> x+y</span><br><span class="line">add = input_print_deca(add)    <span class="comment"># if the add method is a function from third library, you may want to add function to it, this way will help. However, you don&#x27;t need to replace the original method, and you can just assign it to a new one.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## use @ grammar to quick add common code to a function. This has the same effect as the above equation.</span></span><br><span class="line"><span class="meta">@input_print_deca</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">diff</span>(<span class="params">x, y</span>):</span><br><span class="line">  <span class="keyword">return</span> x - y</span><br><span class="line"><span class="meta">@input_print_deca</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">divide</span>(<span class="params">x, y</span>):</span><br><span class="line">  <span class="keyword">assert</span> y != <span class="number">0</span>, <span class="string">&#x27;cannot divide zero&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> x / y</span><br><span class="line"></span><br><span class="line"><span class="comment">## call the decorated functions, notice now there&#x27;s no input</span></span><br><span class="line">add()</span><br><span class="line">diff()</span><br><span class="line">divide()</span><br></pre></td></tr></table></figure>

<p>A single function can have multiple decorators. They are used from top to down. Everytime the original func is called, the current decorator is used.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## define anther two decorators</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">success_deca</span>(<span class="params">func</span>):</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">wrap</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;in success deca&#x27;</span>)</span><br><span class="line">    res = func(x,y)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;yay success!&#x27;</span> + <span class="string">&#x27;*&#x27;</span> * <span class="number">10</span>)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">  <span class="keyword">return</span> wrap</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">success_deca2</span>(<span class="params">func</span>):</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">wrap</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;in success deca2&#x27;</span>)</span><br><span class="line">    res = func(x,y)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;yay success 2&#x27;</span> + <span class="string">&#x27;-&#x27;</span> * <span class="number">10</span>)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">  <span class="keyword">return</span> wrap</span><br><span class="line"></span><br><span class="line"><span class="comment">## use all these decorators</span></span><br><span class="line"><span class="meta">@input_print_deca</span></span><br><span class="line"><span class="meta">@success_deca</span></span><br><span class="line"><span class="meta">@success_deca</span></span><br><span class="line"><span class="meta">@success_deca2</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">diff</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="keyword">return</span> x - y</span><br><span class="line"></span><br><span class="line"><span class="comment">## call the decorated func</span></span><br><span class="line">diff()</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">x: 5        # the call to diff() trigger the input_print_deca decorator</span></span><br><span class="line"><span class="string">y: 6</span></span><br><span class="line"><span class="string">in success deca            # in input_print_deca, the call to func trigger the first success_deca decorator</span></span><br><span class="line"><span class="string">in success deca            # in success_deca, the call to func trigger the second success_deca decorator</span></span><br><span class="line"><span class="string">in success deca2        # in the second success_deca, the call to func trigger the success_deca2 decorator</span></span><br><span class="line"><span class="string">yay success 2----------    # the success_deca2 first return</span></span><br><span class="line"><span class="string">yay success!**********    # the second success_deca return</span></span><br><span class="line"><span class="string">yay success!**********    # the first success_deca return</span></span><br><span class="line"><span class="string">the res: -1                            # the input_print_deca return</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="Generator-1"><a href="#Generator-1" class="headerlink" title="Generator"></a>Generator</h2><p>see <strong>Iterable Containers &#x2F; Generator</strong> above.</p>
<h2 id="async-x2F-await"><a href="#async-x2F-await" class="headerlink" title="async&#x2F;await"></a>async&#x2F;await</h2><p>some links: </p>
<ul>
<li><p><a href="https://www.youtube.com/watch?v=E-1Y4kSsAFc">Fear and Awaiting in Async: A Savage Journey to the Heart of the Coroutine Dream - youtube</a></p>
</li>
<li><p><a href="https://github.com/dabeaz/curio">GitHub - dabeaz&#x2F;curio: Good Curio!</a> a library to separate the asynchronus world and synchronus world by the author of the above video.</p>
</li>
<li><p><a href="https://zhuanlan.zhihu.com/p/38575715">Python Asyncio与多线程&#x2F;多进程那些事</a></p>
</li>
<li><p><a href="https://zhuanlan.zhihu.com/p/27258289">Python Async&#x2F;Await入门指南</a></p>
</li>
<li><p><a href="https://zhuanlan.zhihu.com/p/25354747">从0到1，Python网络编程的入门之路</a></p>
</li>
<li><p><a href="https://zhuanlan.zhihu.com/p/25228075">从0到1，Python异步编程的演进之路</a></p>
</li>
</ul>
<p> <code>async</code> create a coroutine which should be excuted when called. Use <code>await</code> in an async function to hung up the coroutine itself until the awaited coroutine finished. <code>await</code> can only be used in <code>async</code> functions. The  object after <code>await</code> must be an <code>Awaitable</code> (as long as you implement <code>__await__()</code>, it’s an <code>Awaitable</code>.  <code>Coroutine</code> extends from <code>Awaitable</code>)</p>
<p> <code>async</code> can be used anywhere except for:</p>
<ul>
<li><p>lambda</p>
</li>
<li><p>list comprehension (available since python 3.6)</p>
</li>
<li><p>default methods (e.g. <code>__init__()</code>), but we can use metaclass to make <code>__init__</code> awaitable.</p>
</li>
</ul>
<h3 id="eventloop"><a href="#eventloop" class="headerlink" title="eventloop"></a>eventloop</h3><p>The essence of aysncio is an eventloop. All awaitables are added to the eventloop and  wait for executing sequentially. If an event is interrupted by IO or sth, another event will be executed. </p>
<p>For every thread, it has its own eventloop. Events in different eventloops cannot communicate.</p>
<p>So basically, events in asyncio are executed sequentially, whereas their requests to IO may be paralled.</p>
<p>And the <code>await</code> keyword means to emit the Awaitable event at once and the program will wait until it finishes. Thus if we want to emit two or more Awaitable events at almost the same time, we use <code>asyncio.create_task(awaitable)</code>. </p>
<blockquote>
<p>(function) create_task: (coro: Generator[Any, None, _T@create_task] | Coroutine[Any, Any, _T@create_task], *, name: str | None &#x3D; …) -&gt; Task[_T@create_task]</p>
<hr>
<p>Schedule the execution of a coroutine object in a spawn task. </p>
<p>Return a Task object.</p>
</blockquote>
<p>When using <code>create_task</code>, the Awaitable is told to be emited as soon as possible. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> timedelta</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time, time_ns</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ns_to_time</span>(<span class="params">nanoseconds</span>):</span><br><span class="line">    <span class="keyword">return</span> timedelta(microseconds=(nanoseconds/<span class="number">1000</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">now</span>():</span><br><span class="line">  <span class="keyword">return</span> ns_to_time(time_ns())</span><br><span class="line"></span><br><span class="line">first_times = []</span><br><span class="line">second_times = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">print_first</span>(<span class="params">n, if_print = <span class="literal">True</span></span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;now()&#125;</span>: first print start.&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        anow = time_ns()</span><br><span class="line">        first_times.append(anow)</span><br><span class="line">        <span class="keyword">if</span> if_print:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;ns_to_time(anow)&#125;</span>: first-<span class="subst">&#123;i&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">await</span> asyncio.sleep(<span class="number">0.1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;now()&#125;</span>: first print end.&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">print_second</span>(<span class="params">n, if_print = <span class="literal">True</span></span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;now()&#125;</span>: second print start.&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        anow = time_ns()</span><br><span class="line">        second_times.append(anow)</span><br><span class="line">        <span class="keyword">if</span> if_print:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;ns_to_time(anow)&#125;</span>: second-<span class="subst">&#123;i&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">await</span> asyncio.sleep(<span class="number">0.1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;now()&#125;</span>: second print end.&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># task1 &amp; task2 are emitted immediately</span></span><br><span class="line">    task1 = asyncio.create_task(print_first(<span class="number">5</span>))</span><br><span class="line">    task2 = asyncio.create_task(print_second(<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># wait for the two tasks to finish, or the program will end while the tasks are still running.</span></span><br><span class="line">    <span class="keyword">await</span> task1</span><br><span class="line">    <span class="keyword">await</span> task2</span><br><span class="line"></span><br><span class="line">    <span class="comment"># no intersection and the print result shows that all the events are executed sequentially</span></span><br><span class="line">    <span class="built_in">print</span>(first_times)</span><br><span class="line">    <span class="built_in">print</span>(second_times)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;the intersected times: <span class="subst">&#123;<span class="built_in">set</span>(first_times) &amp; <span class="built_in">set</span>(second_times)&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">asyncio.run(main())</span><br></pre></td></tr></table></figure>

<h3 id="async-amp-decorator"><a href="#async-amp-decorator" class="headerlink" title="async &amp; decorator"></a>async &amp; decorator</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建一个 anotation, 可以根据 function 是否在 async 环境运行</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">from_coro</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bool</span>(sys._getframe(n).f_code.co_flags &amp; <span class="number">0x80</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">coro</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        coro.send(<span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">except</span> StopIteration <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> e.value</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">awaitable</span>(<span class="params">syncfunc</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decorator</span>(<span class="params">asyncfunc</span>):</span><br><span class="line"><span class="meta">        @wraps(<span class="params">asyncfunc</span>)</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">            <span class="keyword">if</span> from_coro(<span class="number">2</span>):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;from coro...&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> asyncfunc(*args, **kwargs)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;not from coro...&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> syncfunc(*args, **kwargs)</span><br><span class="line">        <span class="keyword">return</span> wrapper</span><br><span class="line">    <span class="keyword">return</span> decorator</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">spam</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;the blue one&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@awaitable(<span class="params">spam</span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">spam</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;the red one&#x27;</span>)</span><br><span class="line"></span><br><span class="line">spam()</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">await</span> spam()</span><br></pre></td></tr></table></figure>

<h3 id="Awaitable-amp-Coroutine-class"><a href="#Awaitable-amp-Coroutine-class" class="headerlink" title="Awaitable &amp; Coroutine class"></a>Awaitable &amp; Coroutine class</h3><p>The object after <code>await</code> must be an <code>Awaitable</code> (as long as you implement <code>__await__()</code>, it’s an <code>Awaitable</code>. <code>Coroutine</code> extends from <code>Awaitable</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The abstract `Awaitable` and `Coroutine` class:</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Awaitable</span>(metaclass=ABCMeta):</span><br><span class="line">    __slots__ = ()</span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__await__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">yield</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__subclasshook__</span>(<span class="params">cls, C</span>):</span><br><span class="line">        <span class="keyword">if</span> cls <span class="keyword">is</span> Awaitable:</span><br><span class="line">            <span class="keyword">return</span> _check_methods(C, <span class="string">&quot;__await__&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NotImplemented</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Coroutine</span>(<span class="title class_ inherited__">Awaitable</span>):</span><br><span class="line">    __slots__ = ()</span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">send</span>(<span class="params">self, value</span>):</span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">throw</span>(<span class="params">self, typ, val=<span class="literal">None</span>, tb=<span class="literal">None</span></span>):</span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">close</span>(<span class="params">self</span>):</span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__subclasshook__</span>(<span class="params">cls, C</span>):</span><br><span class="line">        <span class="keyword">if</span> cls <span class="keyword">is</span> <span class="type">Coroutine</span>:</span><br><span class="line">            <span class="keyword">return</span> _check_methods(C, <span class="string">&#x27;__await__&#x27;</span>, <span class="string">&#x27;send&#x27;</span>, <span class="string">&#x27;throw&#x27;</span>, <span class="string">&#x27;close&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NotImplemented</span></span><br></pre></td></tr></table></figure>

<h2 id="Some-convinent-functions"><a href="#Some-convinent-functions" class="headerlink" title="Some convinent functions"></a>Some convinent functions</h2><ul>
<li><code>help</code>: eg. <code>help(Exception)</code> or <code>help(e)</code>, to get the methods &amp; data in a class&#x2F;object</li>
<li><code>dir</code> : eg. <code>dir(Exception)</code> or <code>dir(e)</code>, is a simple version of <code>help</code>, shows all members as a string</li>
<li><code>inspect.getmro(type(e))</code>: get the class hierachy of a type</li>
</ul>
<h1 id="Major-3rd-Party-Libraries"><a href="#Major-3rd-Party-Libraries" class="headerlink" title="Major 3rd-Party Libraries"></a>Major 3rd-Party Libraries</h1><p><strong>Django</strong>: The most frequently used web framework written in Python, Django powers websites that include Instagram and Disqus. It has many useful features, and whatever features it lacks are covered by extension packages.<br><strong>CherryPy</strong> and <strong>Flask</strong> are also popular web frameworks.<br><strong>BeautifulSoup</strong> is very useful when scraping data from websites, and leads to better results than building your own scraper with regular expressions.</p>
<p>A number of third-party modules are available that make it much easier to carry out scientific and mathematical computing with Python.<br>The module <strong>matplotlib</strong> allows you to create graphs based on data in Python.<br>The module <strong>NumPy</strong> allows for the use of multidimensional arrays that are much faster than the native Python solution of nested lists. It also contains functions to perform mathematical operations such as matrix transformations on the arrays.<br>The library <strong>SciPy</strong> contains numerous extensions to the functionality of <strong>NumPy</strong>.</p>
<p>Python can also be used for <strong>game development</strong>.<br>Usually, it is used as a scripting language for games written in other languages, but it can be used to make games by itself.<br>For 3D games, the library <strong>Panda3D</strong> can be used. For 2D games, you can use <strong>pygame</strong>.</p>
<h1 id="Issues"><a href="#Issues" class="headerlink" title="# Issues"></a># Issues</h1><h2 id="Make-class-method-return-self-type"><a href="#Make-class-method-return-self-type" class="headerlink" title="Make class method return self type"></a>Make class method return self type</h2><p><a href="https://stackoverflow.com/questions/33533148/how-do-i-type-hint-a-method-with-the-type-of-the-enclosing-class">https://stackoverflow.com/questions/33533148/how-do-i-type-hint-a-method-with-the-type-of-the-enclosing-class</a></p>
<p>If you are using Python 3.10 or later, it just works. As of today (2019) in 3.7+ you must turn this feature on using a future statement (<code>from __future__ import annotations</code>) - for Python 3.6 or below use a string.</p>
<h3 id="Python-3-7-from-future-import-annotations"><a href="#Python-3-7-from-future-import-annotations" class="headerlink" title="Python 3.7+: from __future__ import annotations"></a>Python 3.7+: <code>from __future__ import annotations</code></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> annotations</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Position</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__add__</span>(<span class="params">self, other: Position</span>) -&gt; Position:</span><br><span class="line">        ...</span><br></pre></td></tr></table></figure>

<h3 id="Python-lt-3-7-use-a-string"><a href="#Python-lt-3-7-use-a-string" class="headerlink" title="Python &lt;3.7: use a string"></a>Python &lt;3.7: use a string</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Position</span>:</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__add__</span>(<span class="params">self, other: <span class="string">&#x27;Position&#x27;</span></span>) -&gt; <span class="string">&#x27;Position&#x27;</span>:</span><br><span class="line">       ...</span><br></pre></td></tr></table></figure>

<h2 id="Circular-import"><a href="#Circular-import" class="headerlink" title="Circular import"></a>Circular import</h2><p><a href="https://zhuanlan.zhihu.com/p/66228942">circular import</a></p>
<p>modify the position of import to fix the issues</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://hfcherish.github.io/2019/03/01/k8s/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Cherish">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cherish's Blog">
      <meta itemprop="description" content="从心所欲不逾矩">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Cherish's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/03/01/k8s/" class="post-title-link" itemprop="url">k8s general</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-03-01 15:41:12" itemprop="dateCreated datePublished" datetime="2019-03-01T15:41:12+08:00">2019-03-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-10-22 14:22:52" itemprop="dateModified" datetime="2022-10-22T14:22:52+08:00">2022-10-22</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="WORDS">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">WORDS:</span>
      <span>0</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a href="https://kubernetes.io/docs/concepts/overview/what-is-kubernetes/">k8s</a> is a platform to manage containerized workloads and services.</p>
<h1 id="Concepts"><a href="#Concepts" class="headerlink" title="Concepts"></a>Concepts</h1><h2 id="kubernetes-Objects"><a href="#kubernetes-Objects" class="headerlink" title="kubernetes Objects"></a>kubernetes Objects</h2><ol>
<li>Kubernetes abstract <strong>a desired state of cluster</strong> as objects.</li>
<li>an object configuration includes:<ol>
<li>spec: describe the desired state<ol>
<li>apiVersion: the api version of kubernetes</li>
<li>metadata: the name &amp; namespace</li>
<li>spec: the desired state definition.</li>
</ol>
</li>
<li>status: describe the actual state of the object</li>
</ol>
</li>
<li>cluster state (<a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/kubernetes-objects/">understanding kubernetes objects</a>):<ol>
<li>what containerized applications are running and where they’re running</li>
<li>how many resources (disk, network, etc.) are attached to the the container</li>
<li>the policies around how the application behaves, such as restart policies, fault-tolerance, etc.</li>
</ol>
</li>
</ol>
<h3 id="Workloads"><a href="#Workloads" class="headerlink" title="Workloads"></a>Workloads</h3><p>Objects that set deployment rules of pods.</p>
<p>All controllers are workloads.</p>
<h3 id="POD"><a href="#POD" class="headerlink" title="POD"></a>POD</h3><p><a href="https://kubernetes.io/docs/concepts/workloads/pods/pod-overview/">pod</a> is <strong>a minimize runnable object</strong> in k8s object model.</p>
<p>A Pod encapsulates an application <em>container</em> (or, in some cases, multiple containers), <em>storage resources</em>, <em>a unique network IP</em>, and <em>options that govern how the container(s) should run.</em></p>
<p>It represents <strong>a single instances of application</strong>.</p>
<p>There’re two common use cases:</p>
<ul>
<li><strong>Pods that run a single container</strong>, which is the most case. So often pod is a synomynous with container.</li>
<li><strong>Pods that run multiple containers that need to work together.</strong> All the containers in a pod share the storage &amp; network, which means they use the same ip and same storage volume.</li>
</ul>
<h4 id="Pod-lifecycle"><a href="#Pod-lifecycle" class="headerlink" title="Pod lifecycle"></a>Pod lifecycle</h4><p><strong>A pod doesn’t self-heal &amp; self-scale</strong>. It’s just a running instance. It stopped &amp; deleted when the process is finished, or the node is failed, or the resource is exhaused… Controllers (eg. deployment, statefulSet…) instead can create and manage multiple pods.</p>
<p>Pod restarting is different from container restarting. <strong>Pod provides the env for containers: os, storage, network…</strong></p>
<h3 id="Controllers"><a href="#Controllers" class="headerlink" title="Controllers"></a>Controllers</h3><p>Controllers (eg. deployment, statefulSet…) instead can create and manage multiple pods.</p>
<h3 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h3><p>Service is an <strong>abstraction</strong> which defines <strong>a logical set of pods</strong>, and <strong>a policy by which to access the pods</strong>.</p>
<p>It enables <strong>the decoupling of access &amp; the real pods</strong>, which means you can access by service name&#x2F;ip rather than the pod ip, while <strong>pod ip is not stable</strong>.</p>
<blockquote>
<p>Q: How does k8s get all pod endpoints by service?</p>
<p>A: By <code>LabelSelector</code>. You can define labels for each pod. And we define <code>LabelSelector</code> in service, so that k8s can search pod node by label first, and then using the <code>targetPort</code> to locate the pod on node.</p>
</blockquote>
<h2 id="kubernetes-control-plane"><a href="#kubernetes-control-plane" class="headerlink" title="kubernetes control plane"></a>kubernetes control plane</h2><ol>
<li>the control plane <strong>manage the cluster state to match the desired state of objects</strong></li>
<li>the control plane consists of a collection of processes for the above intention.<ol>
<li>kubernetes master:<ol>
<li>is responsible for the maintaining the desired state.</li>
<li>“master” in fact refers to three processes: <a href="https://kubernetes.io/docs/admin/kube-apiserver/">kube-apiserver</a>, <a href="https://kubernetes.io/docs/admin/kube-controller-manager/">kube-controller-manager</a> and <a href="https://kubernetes.io/docs/admin/kube-scheduler/">kube-scheduler</a>.</li>
<li>these three processes are typically run on single node in the cluster. This node is called “master”, too. The master can also be replicated for avaibility and redundancy.</li>
</ol>
</li>
<li>kubernetes nodes:<ol>
<li>the nodes to run applications.</li>
<li>there’re two process in each node:<ol>
<li>kubelet: communicate with the master</li>
<li>kube-proxy: a network proxy.</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<h1 id="kubernetes-api"><a href="#kubernetes-api" class="headerlink" title="kubernetes api"></a>kubernetes api</h1><p>The <strong>api</strong> communicates with master to operate on kubernetes objects.</p>
<p><strong>kubectl</strong> is a cli to implement the above intention. It in fact calls the api internally.</p>
<p>All kinds of <strong>sdk</strong> (java, python…) encapsulate the api, too.</p>
<p>There are two kinds of api groups:</p>
<ol>
<li>core groups: the original k8s api</li>
<li>other groups: other api to extend the core group, like you may want to abstract more objects?</li>
</ol>
<h1 id="Access-services-on-cluster"><a href="#Access-services-on-cluster" class="headerlink" title="Access services on cluster"></a>Access services on cluster</h1><p>There are several levels.</p>
<p>ip:</p>
<ul>
<li>pod ip: </li>
<li>cluster ip: the virtual ip for a service</li>
<li>node ip</li>
</ul>
<h2 id="In-pod-access"><a href="#In-pod-access" class="headerlink" title="In-pod access"></a>In-pod access</h2><p><strong>Each pod has a unique IP</strong>.  And all <strong>containers in a pod share the ip</strong>, which means that they can access each other by <code>localhost</code></p>
<h2 id="In-cluster-access"><a href="#In-cluster-access" class="headerlink" title="In-cluster access"></a>In-cluster access</h2><p>By default, a service can be accessed by other pods in the same cluster, through:</p>
<h4 id="cluster-ip-port"><a href="#cluster-ip-port" class="headerlink" title="cluster-ip:port"></a>cluster-ip:port</h4><ul>
<li>cluster ip is the virtual ip of a service</li>
<li>port is is the node port of the service.</li>
</ul>
<p>Every node on k8s has a <code>kube-proxy</code>. It installs iptable rules which keep a simple record of (servicename:clusterip:serviceport).</p>
<p>In some node:</p>
<ol>
<li>call cluster-ip:port————— <strong>In a pod</strong></li>
<li>the kube-proxy search the iptable, and get some info.———— <strong>pod &#x3D;&gt; kube-proxy of node where the pod resides.</strong></li>
<li>the kube-proxy using the info to ask master for the real endpoints.—— <strong>kube-proxy of node &#x3D;&gt; master kube-api</strong></li>
<li>the kube-proxy chooses a endpoint by <code>SessionAffinity</code> defined in service (round-robin by default) —— <strong>in kube-proxy</strong></li>
<li>the kube-proxy redirect request to <code>pod-ip:podPort</code> —— <strong>kube-proxy &#x3D;&gt; pod endpoint</strong></li>
</ol>
<p>kube-proxy: enables the Kubernetes service abstraction by maintaining network rules on the host and performing connection forwarding</p>
<p><img src="https://d33wubrfki0l68.cloudfront.net/e351b830334b8622a700a8da6568cb081c464a9b/13020/images/docs/services-userspace-overview.svg" alt="proxy-mode:user space"></p>
<h4 id="servicename-namespacename"><a href="#servicename-namespacename" class="headerlink" title="servicename.namespacename"></a>servicename.namespacename</h4><p>When accessing by service name, there’re two ways:</p>
<h5 id="environement-viaribles"><a href="#environement-viaribles" class="headerlink" title="environement viaribles"></a>environement viaribles</h5><p>when create a service, k8s will create some env for each serivce, e.g. <code>&#123;SVCNAME_CAPTIPAL&#125;_SERVICE_HOST</code>. So the kube-proxy in fact gets the service cluster ip from these envs first. When a pod calls a service, t<strong>he service must be created before the pod</strong> so that the envs are created.</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># the cluster ip</span></span><br><span class="line"><span class="attr">REDIS_MASTER_SERVICE_HOST</span>=<span class="string">10.0.0.11</span></span><br><span class="line"><span class="attr">REDIS_MASTER_SERVICE_PORT</span>=<span class="string">6379</span></span><br><span class="line"><span class="attr">REDIS_MASTER_PORT</span>=<span class="string">tcp://10.0.0.11:6379</span></span><br><span class="line"><span class="attr">REDIS_MASTER_PORT_6379_TCP</span>=<span class="string">tcp://10.0.0.11:6379</span></span><br><span class="line"><span class="attr">REDIS_MASTER_PORT_6379_TCP_PROTO</span>=<span class="string">tcp</span></span><br><span class="line"><span class="attr">REDIS_MASTER_PORT_6379_TCP_PORT</span>=<span class="string">6379</span></span><br><span class="line"><span class="attr">REDIS_MASTER_PORT_6379_TCP_ADDR</span>=<span class="string">10.0.0.11</span></span><br></pre></td></tr></table></figure>

<h5 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a><a href="https://kubernetes.io/docs/concepts/services-networking/service/#dns">DNS</a></h5><p>It’s an add-on k8s object, which can be chosed to add to the cluster.</p>
<p>It’s an in-cluster dns, which serves DNS records for Kubernetes services.</p>
<p>It watches the k8s api for new services and create <strong>DNS SVC records</strong> for each.</p>
<p>Containers started by Kubernetes automatically include this DNS server in their DNS searches.</p>
<h2 id="between-cluster-access"><a href="#between-cluster-access" class="headerlink" title="between-cluster access"></a>between-cluster access</h2><ol>
<li>NodePort: expose nodeIP</li>
<li>LoadBalancer: expose loadbalancer ip</li>
<li>Ingress: expose loadbalancer &amp; path</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://hfcherish.github.io/2019/03/01/obs/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Cherish">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cherish's Blog">
      <meta itemprop="description" content="从心所欲不逾矩">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Cherish's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/03/01/obs/" class="post-title-link" itemprop="url">obs</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-03-01 10:50:15" itemprop="dateCreated datePublished" datetime="2019-03-01T10:50:15+08:00">2019-03-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-10-22 14:22:52" itemprop="dateModified" datetime="2022-10-22T14:22:52+08:00">2022-10-22</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="WORDS">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">WORDS:</span>
      <span>0</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a href="https://support.huaweicloud.com/productdesc-obs/zh-cn_topic_0045829060.html">Huawei Obs</a> is an object storage service on cloud.</p>
<h1 id="Concepts"><a href="#Concepts" class="headerlink" title="Concepts"></a>Concepts</h1><h2 id="Object"><a href="#Object" class="headerlink" title="Object"></a>Object</h2><ol>
<li>The real complete file or byte stream to save</li>
<li><strong>object name is the unique id</strong> in a bucket<ol>
<li>it’s used as <strong>part of url path</strong>. The naming restrictions are fit to url path naming restrictions.</li>
</ol>
</li>
<li>Access(based on version in fact)<ol>
<li>Object ACL:<ol>
<li>general control to object: <strong>read object, read&#x2F;write object ACL, only users in the same account</strong></li>
</ol>
</li>
<li>Object policy<ol>
<li>fine-grained control to object: <strong>fine-grained actions(put,delete…) on object, all users</strong></li>
</ol>
</li>
</ol>
</li>
<li><strong>multi-versions</strong><ol>
<li>an object can has multiple versions, each of which has an unique id.</li>
<li>Whether there’s multi-version, it’s a policy set on a bucket.</li>
</ol>
</li>
<li>directory:<ol>
<li><strong>directory is just a view</strong>. Essentially, it’s an empty object end with “&#x2F;“.</li>
<li><strong>all objects in a bucket are on the same level</strong>. There’s no multi-level directory in fact.</li>
<li>to create the directory view, you need to create an object with name ending with “&#x2F;“ explicility, eg. “sub1&#x2F;sub2&#x2F; . It will create a two-level dir in console. There’s no need to create “sub1&#x2F;“ first then “sub1&#x2F;sub2”.</li>
</ol>
</li>
<li>object actions:<ol>
<li>For writing, there’s <strong>only write&#x2F;restricted-append&#x2F;delete, no put</strong></li>
<li><strong>basically-write-once-read-many</strong></li>
</ol>
</li>
<li>upload modes:<ol>
<li>stream</li>
<li>file</li>
<li>multi-part (support breakpoint resume)</li>
<li>append</li>
</ol>
</li>
</ol>
<h2 id="Bucket"><a href="#Bucket" class="headerlink" title="Bucket"></a>Bucket</h2><ol>
<li>The place to save objects</li>
<li><strong>bucket name is the unique id</strong> for one account(a tenant).<ol>
<li>it’s used as <strong>part of domain name</strong> on url. The naming restrictions are fit to domain naming restrictions.</li>
</ol>
</li>
<li>Access<ol>
<li>Bucket ACL: <ol>
<li>general control to bucket and all objects in bucket: <strong>read&#x2F;put buckets, read&#x2F;write bucket ACL, only users in the same account</strong></li>
</ol>
</li>
<li>Bucket policy<ol>
<li>fine-grained control to specific objects in bucket: <strong>fine-grained actions on bucket or specific objects in bucket, all users</strong></li>
</ol>
</li>
</ol>
</li>
<li>storage type<ol>
<li>standard: <ol>
<li><strong>quick access &amp; high throughput</strong>. It’s used for high access requests and not so big files.</li>
</ol>
</li>
<li>warm:<ol>
<li><strong>low access.</strong></li>
</ol>
</li>
<li>cold:<ol>
<li><strong>very very low access</strong></li>
</ol>
</li>
</ol>
</li>
</ol>
<h2 id="region"><a href="#region" class="headerlink" title="region"></a>region</h2><p>The region of nodes where the storage really happens.</p>
<h2 id="signature"><a href="#signature" class="headerlink" title="signature"></a>signature</h2><p>The signature to identify a user when accessing buckets&#x2F;objects.</p>
<ol>
<li>ak(access key): represent a user. one user can have multi aks. It’s kind of like an user role</li>
<li>sk(secret key): one-to-one corresponding with ak. The secret key used for RSA authentication &amp; authorization.</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://hfcherish.github.io/2019/01/30/pipeline-process-beam/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Cherish">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cherish's Blog">
      <meta itemprop="description" content="从心所欲不逾矩">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Cherish's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/01/30/pipeline-process-beam/" class="post-title-link" itemprop="url">pipeline process: beam</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-01-30 17:02:49" itemprop="dateCreated datePublished" datetime="2019-01-30T17:02:49+08:00">2019-01-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-10-22 14:22:52" itemprop="dateModified" datetime="2022-10-22T14:22:52+08:00">2022-10-22</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="WORDS">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">WORDS:</span>
      <span>0</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="What’s-beam"><a href="#What’s-beam" class="headerlink" title="What’s beam"></a>What’s beam</h1><p><a href="https://beam.apache.org/get-started/beam-overview/">beam</a> is a open-source, unified model for defining both batched &amp; streaming data-parallel processing pipelines.</p>
<ul>
<li>open-source (apache v2 license)</li>
<li>to define data-parallel processing pipelines</li>
<li>an unified model to define pipelines. The real processing is run by the underlying runner (eg. spark, apache apex, etc.). <a href="https://beam.apache.org/get-started/beam-overview/">all available runners</a></li>
<li>can process both batched  (bounded datasets) &amp; streaming (unbounded datasets) datasets</li>
</ul>
<h1 id="Use-it"><a href="#Use-it" class="headerlink" title="Use it"></a>Use it</h1><p>See the <a href="https://beam.apache.org/get-started/beam-overview/">wordcount examples</a>, <a href="https://github.com/apache/beam/blob/master/examples/java/src/main/java/org/apache/beam/examples/MinimalWordCount.java">wordcount src</a></p>
<p>Now we define a simple pipeline and run it.</p>
<p><code>Transform</code>, <code>Count</code> are all built-in atom operations to define the pipeline scripts.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.apache.beam.examples;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> org.apache.beam.sdk.Pipeline;</span><br><span class="line"><span class="keyword">import</span> org.apache.beam.sdk.io.TextIO;</span><br><span class="line"><span class="keyword">import</span> org.apache.beam.sdk.options.PipelineOptions;</span><br><span class="line"><span class="keyword">import</span> org.apache.beam.sdk.options.PipelineOptionsFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.beam.sdk.transforms.Count;</span><br><span class="line"><span class="keyword">import</span> org.apache.beam.sdk.transforms.Filter;</span><br><span class="line"><span class="keyword">import</span> org.apache.beam.sdk.transforms.FlatMapElements;</span><br><span class="line"><span class="keyword">import</span> org.apache.beam.sdk.transforms.MapElements;</span><br><span class="line"><span class="keyword">import</span> org.apache.beam.sdk.values.KV;</span><br><span class="line"><span class="keyword">import</span> org.apache.beam.sdk.values.TypeDescriptors;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MinimalWordCount</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Create a PipelineOptions object. This object lets us set various execution</span></span><br><span class="line">    <span class="comment">// options for our pipeline, such as the runner you wish to use.</span></span><br><span class="line">    <span class="type">PipelineOptions</span> <span class="variable">options</span> <span class="operator">=</span> PipelineOptionsFactory.create();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Create the Pipeline object with the options we defined above</span></span><br><span class="line">    <span class="type">Pipeline</span> <span class="variable">p</span> <span class="operator">=</span> Pipeline.create(options);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Concept #1: Apply a root transform to the pipeline; in this case, TextIO.Read to read a set</span></span><br><span class="line">    p.apply(TextIO.read().from(<span class="string">&quot;gs://apache-beam-samples/shakespeare/*&quot;</span>))</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Concept #2: Apply a FlatMapElements transform the PCollection of text lines.</span></span><br><span class="line">        .apply(</span><br><span class="line">            FlatMapElements.into(TypeDescriptors.strings())</span><br><span class="line">                .via((String word) -&gt; Arrays.asList(word.split(<span class="string">&quot;[^\\p&#123;L&#125;]+&quot;</span>))))</span><br><span class="line">        .apply(Filter.by((String word) -&gt; !word.isEmpty()))</span><br><span class="line">        <span class="comment">// Concept #3: Apply the Count transform to our PCollection of individual words. </span></span><br><span class="line">        .apply(Count.perElement())</span><br><span class="line">        .apply(</span><br><span class="line">            MapElements.into(TypeDescriptors.strings())</span><br><span class="line">                .via(</span><br><span class="line">                    (KV&lt;String, Long&gt; wordCount) -&gt;</span><br><span class="line">                        wordCount.getKey() + <span class="string">&quot;: &quot;</span> + wordCount.getValue()))</span><br><span class="line">        <span class="comment">// Concept #4: Apply a write transform, TextIO.Write, at the end of the pipeline.</span></span><br><span class="line">        .apply(TextIO.write().to(<span class="string">&quot;wordcounts&quot;</span>));</span><br><span class="line"></span><br><span class="line">    p.run().waitUntilFinish();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Some-conceptions"><a href="#Some-conceptions" class="headerlink" title="Some conceptions"></a>Some conceptions</h1><h2 id="I-x2F-O-data-source-x2F-target"><a href="#I-x2F-O-data-source-x2F-target" class="headerlink" title="I&#x2F;O (data source&#x2F;target)"></a>I&#x2F;O (data source&#x2F;target)</h2><p>Beam can process both batched  (bounded datasets) &amp; streaming (unbounded datasets) datasets. <a href="https://beam.apache.org/documentation/io/built-in/">built-in io transforms</a></p>
<p>Take reading as example, you specify the file location (the location must be accessable for the runner), and then the reader pull from datasource. You may also define the trigger to collect input window. When trigger is satisfied, window elements are emitted.</p>
<p>For unbounded datasets, they are split into windows. And each window is again a bounded datasets. In each window, there’re some elements. You can define how the elements are grouped as a window and when to emit the window elements for processing. <a href="https://beam.apache.org/documentation/programming-guide/#windowing">window concept</a></p>
<h2 id="Runner"><a href="#Runner" class="headerlink" title="Runner"></a>Runner</h2><p>Beam is an unified model. It abstracts the conception to define and run a pipeline. The real execution is conducted by the underlying runners.</p>
<p><a href="https://beam.apache.org/get-started/beam-overview/">all available runners</a></p>
<p>For unbounded datasets, the underlying runner must support stream processing.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://hfcherish.github.io/2019/01/23/linux-command/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Cherish">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cherish's Blog">
      <meta itemprop="description" content="从心所欲不逾矩">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Cherish's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/01/23/linux-command/" class="post-title-link" itemprop="url">linux commands</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-01-23 15:32:13" itemprop="dateCreated datePublished" datetime="2019-01-23T15:32:13+08:00">2019-01-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-02-14 17:05:07" itemprop="dateModified" datetime="2023-02-14T17:05:07+08:00">2023-02-14</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="WORDS">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">WORDS:</span>
      <span>0</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="chmod-chown"><a href="#chmod-chown" class="headerlink" title="chmod, chown"></a>chmod, chown</h1><p><a href="https://www.linux.com/learn/understanding-linux-file-permissions">understanding linux file permissions</a></p>
<p>File permissions are defined by <strong>permission group</strong> and <strong>permission type</strong></p>
<ol>
<li>permission group<ul>
<li>owner(u)</li>
<li>group(g)</li>
<li>all other users(a)</li>
</ul>
</li>
<li>permission type<ul>
<li>read (r - 4)</li>
<li>write(w - 2)</li>
<li>execute(x - 1)</li>
</ul>
</li>
</ol>
<h2 id="permission-presentation"><a href="#permission-presentation" class="headerlink" title="permission presentation"></a>permission presentation</h2><p>The permission in the command line is displayed as <em><strong>_rwxrwxrwx 1 owner:group</strong></em></p>
<ul>
<li>the first character (underscore <strong>_</strong>  here) is the <strong>special permission flag</strong> that can vary.</li>
<li>the following three groups of <em><strong>rwx</strong></em> represent <strong>permission of owner, group and all other users</strong> respectively. If the owner and all users has no read permission, it is <em><strong>__wxrwx_wx</strong></em></li>
<li>follwing that grouping since the integer displays <strong>the number of hardlinks to the file</strong></li>
<li>the last piece is the owner and group assignment.</li>
</ul>
<h3 id="special-permission-flag"><a href="#special-permission-flag" class="headerlink" title="special permission flag"></a>special permission flag</h3><p>The special permission flag can be:</p>
<ul>
<li><strong>_</strong>: no special permissions</li>
<li><em><strong>d</strong></em>: directory</li>
<li><em><strong>l</strong></em>: the file or dir is a symbolic link</li>
<li><em><strong>s</strong></em>: This indicated the setuid&#x2F;setgid permissions. This is not set displayed in the special permission part of the permissions display, but is represented as a <strong>s</strong> in the read portion of the owner or group permissions.</li>
<li><em><strong>t</strong></em>: This indicates the sticky bit permissions. This is not set displayed in the special permission part of the permissions display, but is represented as a <strong>t</strong> in the executable portion of the all users permissions</li>
</ul>
<h2 id="permission-modification"><a href="#permission-modification" class="headerlink" title="permission modification"></a>permission modification</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># grant read and write permissions to the user and group</span></span><br><span class="line">$ <span class="built_in">chmod</span> ug+rw file1</span><br><span class="line"></span><br><span class="line"><span class="comment"># remove read and write permissions to the user and group</span></span><br><span class="line">$ <span class="built_in">chmod</span> ug-rw file1</span><br><span class="line"></span><br><span class="line"><span class="comment"># set permission using binary references (owner: rwx = 4+2+1, group: rx = 4+1, all users: rx = 4+1)</span></span><br><span class="line">$ <span class="built_in">chmod</span> 755 file1</span><br><span class="line"></span><br><span class="line"><span class="comment"># change the file permission recursively in the file/dir instead of just the files themselves</span></span><br><span class="line">$ <span class="built_in">chmod</span> -R 755 dir1</span><br></pre></td></tr></table></figure>

<h2 id="change-owner-group-assignments"><a href="#change-owner-group-assignments" class="headerlink" title="change owner:group assignments"></a>change owner:group assignments</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># change the owner of file1 to user1 and group to family</span></span><br><span class="line">$ <span class="built_in">chown</span> user1:family file1</span><br></pre></td></tr></table></figure>

<h1 id="find"><a href="#find" class="headerlink" title="find"></a>find</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># find all xml files from the current dir</span></span><br><span class="line">$ find ./* -name <span class="string">&#x27;*.xml&#x27;</span></span><br></pre></td></tr></table></figure>

<p>To find all files modified in the last 24 hours (last full day) in a particular specific directory and its sub-directories:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ find /directory_path -mtime -1 -<span class="built_in">ls</span></span><br></pre></td></tr></table></figure>

<p>Should be to your liking</p>
<p>The <code>-</code> before <code>1</code> is important - it means anything changed one day or less ago. A <code>+</code> before <code>1</code> would instead mean anything changed at least one day ago, while having nothing before the <code>1</code> would have meant it was changed exacted one day ago, no more, no less.</p>
<p>Another, more humane way:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /&lt;directory&gt; -newermt <span class="string">&quot;-24 hours&quot;</span> -<span class="built_in">ls</span></span><br></pre></td></tr></table></figure>

<p>or:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /&lt;directory&gt; -newermt <span class="string">&quot;1 day ago&quot;</span> -<span class="built_in">ls</span></span><br></pre></td></tr></table></figure>

<p>or:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /&lt;directory&gt; -newermt <span class="string">&quot;yesterday&quot;</span> -<span class="built_in">ls</span></span><br></pre></td></tr></table></figure>

<h1 id="rm"><a href="#rm" class="headerlink" title="rm"></a>rm</h1><p>找到文件并删除</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">find /home/raven -name abc.txt | xargs rm -rf</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">不使用 xargs</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="ls"><a href="#ls" class="headerlink" title="ls"></a>ls</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># list file with creation date and sort by it</span></span><br><span class="line">$ <span class="built_in">ls</span> -lct</span><br></pre></td></tr></table></figure>

<h1 id="du"><a href="#du" class="headerlink" title="du"></a>du</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">du</span> -sh -- * | <span class="built_in">sort</span> -hr</span><br></pre></td></tr></table></figure>

<h1 id="List-users"><a href="#List-users" class="headerlink" title="List users"></a>List users</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cat</span> /etc/passwd | <span class="built_in">cut</span> -d: -f1</span><br></pre></td></tr></table></figure>

<h1 id="pbcopy"><a href="#pbcopy" class="headerlink" title="pbcopy"></a>pbcopy</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># copy file content to clipboard</span></span><br><span class="line">$ pbcopy &lt; test.txt</span><br></pre></td></tr></table></figure>

<h1 id="dstat"><a href="#dstat" class="headerlink" title="dstat"></a>dstat</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ dstat -t -a --tcp --output network.log</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://hfcherish.github.io/2019/01/17/lombok/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Cherish">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cherish's Blog">
      <meta itemprop="description" content="从心所欲不逾矩">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Cherish's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/01/17/lombok/" class="post-title-link" itemprop="url">lombok</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-01-17 10:24:55" itemprop="dateCreated datePublished" datetime="2019-01-17T10:24:55+08:00">2019-01-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-10-22 14:22:52" itemprop="dateModified" datetime="2022-10-22T14:22:52+08:00">2022-10-22</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="WORDS">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">WORDS:</span>
      <span>0</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a href="https://projectlombok.org/">lombok</a> is a library to help your <strong>write java cleaner and more efficiently</strong>. It’s plugged into the editor and build tool, which works <strong>at compile time</strong>. </p>
<p>Essentially, it modifies the byte-codes by operating AST (abstract semantic tree) at compile time, which is allowed by javac. This is, in fact, a way to modify java grammar.</p>
<h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><p>To use it,</p>
<ol>
<li>install lombok plugin in intellij</li>
<li>add package dependency in project (to use its annotations)</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.16.18<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>See <a href="https://projectlombok.org/features/all">all the annotations</a>. Give some example here:</p>
<h3 id="Data"><a href="#Data" class="headerlink" title="@Data"></a>@Data</h3><p><a href="https://projectlombok.org/features/Data"><code>@Data</code></a> bundles the features of   <a href="https://projectlombok.org/features/ToString"><code>@ToString</code></a>, <a href="https://projectlombok.org/features/EqualsAndHashCode"><code>@EqualsAndHashCode</code></a>, <a href="https://projectlombok.org/features/GetterSetter"><code>@Getter</code> &#x2F; <code>@Setter</code></a> and <a href="https://projectlombok.org/features/constructor"><code>@RequiredArgsConstructor</code></a> together.</p>
<p><strong>With lombok:</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.AccessLevel;</span><br><span class="line"><span class="keyword">import</span> lombok.Setter;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.ToString;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span> <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataExample</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line">  <span class="meta">@Setter(AccessLevel.PACKAGE)</span> <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">double</span> score;</span><br><span class="line">  <span class="keyword">private</span> String[] tags;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@ToString(includeFieldNames=true)</span></span><br><span class="line">  <span class="meta">@Data(staticConstructor=&quot;of&quot;)</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Exercise</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> T value;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Vanila java:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataExample</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">double</span> score;</span><br><span class="line">  <span class="keyword">private</span> String[] tags;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">DataExample</span><span class="params">(String name)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.name;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.age = age;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.age;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setScore</span><span class="params">(<span class="type">double</span> score)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.score = score;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getScore</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.score;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> String[] getTags() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.tags;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setTags</span><span class="params">(String[] tags)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.tags = tags;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">   <span class="meta">@Override</span> <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;DataExample(&quot;</span> + <span class="built_in">this</span>.getName() + <span class="string">&quot;, &quot;</span> + <span class="built_in">this</span>.getAge() + <span class="string">&quot;, &quot;</span> + <span class="built_in">this</span>.getScore() + <span class="string">&quot;, &quot;</span> + Arrays.deepToString(<span class="built_in">this</span>.getTags()) + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">canEqual</span><span class="params">(Object other)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> other <span class="keyword">instanceof</span> DataExample;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Override</span> <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (o == <span class="built_in">this</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (!(o <span class="keyword">instanceof</span> DataExample)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="type">DataExample</span> <span class="variable">other</span> <span class="operator">=</span> (DataExample) o;</span><br><span class="line">    <span class="keyword">if</span> (!other.canEqual((Object)<span class="built_in">this</span>)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.getName() == <span class="literal">null</span> ? other.getName() != <span class="literal">null</span> : !<span class="built_in">this</span>.getName().equals(other.getName())) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.getAge() != other.getAge()) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (Double.compare(<span class="built_in">this</span>.getScore(), other.getScore()) != <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (!Arrays.deepEquals(<span class="built_in">this</span>.getTags(), other.getTags())) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Override</span> <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> <span class="variable">PRIME</span> <span class="operator">=</span> <span class="number">59</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">long</span> <span class="variable">temp1</span> <span class="operator">=</span> Double.doubleToLongBits(<span class="built_in">this</span>.getScore());</span><br><span class="line">    result = (result*PRIME) + (<span class="built_in">this</span>.getName() == <span class="literal">null</span> ? <span class="number">43</span> : <span class="built_in">this</span>.getName().hashCode());</span><br><span class="line">    result = (result*PRIME) + <span class="built_in">this</span>.getAge();</span><br><span class="line">    result = (result*PRIME) + (<span class="type">int</span>)(temp1 ^ (temp1 &gt;&gt;&gt; <span class="number">32</span>));</span><br><span class="line">    result = (result*PRIME) + Arrays.deepHashCode(<span class="built_in">this</span>.getTags());</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Exercise</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> T value;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Exercise</span><span class="params">(String name, T value)</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.name = name;</span><br><span class="line">      <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Exercise&lt;T&gt; <span class="title function_">of</span><span class="params">(String name, T value)</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Exercise</span>&lt;T&gt;(name, value);</span><br><span class="line">      &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">this</span>.name;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> T <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">this</span>.value;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span> <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;Exercise(name=&quot;</span> + <span class="built_in">this</span>.getName() + <span class="string">&quot;, value=&quot;</span> + <span class="built_in">this</span>.getValue() + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">canEqual</span><span class="params">(Object other)</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> other <span class="keyword">instanceof</span> Exercise;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span> <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (o == <span class="built_in">this</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">if</span> (!(o <span class="keyword">instanceof</span> Exercise)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">      Exercise&lt;?&gt; other = (Exercise&lt;?&gt;) o;</span><br><span class="line">      <span class="keyword">if</span> (!other.canEqual((Object)<span class="built_in">this</span>)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">this</span>.getName() == <span class="literal">null</span> ? other.getValue() != <span class="literal">null</span> : !<span class="built_in">this</span>.getName().equals(other.getName())) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">this</span>.getValue() == <span class="literal">null</span> ? other.getValue() != <span class="literal">null</span> : !<span class="built_in">this</span>.getValue().equals(other.getValue())) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span> <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123;</span><br><span class="line">      <span class="keyword">final</span> <span class="type">int</span> <span class="variable">PRIME</span> <span class="operator">=</span> <span class="number">59</span>;</span><br><span class="line">      <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">      result = (result*PRIME) + (<span class="built_in">this</span>.getName() == <span class="literal">null</span> ? <span class="number">43</span> : <span class="built_in">this</span>.getName().hashCode());</span><br><span class="line">      result = (result*PRIME) + (<span class="built_in">this</span>.getValue() == <span class="literal">null</span> ? <span class="number">43</span> : <span class="built_in">this</span>.getValue().hashCode());</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Cherish</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>Word count total: </span>
    <span title="Word count total">314k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>Reading time total &asymp;</span>
    <span title="Reading time total">4:46</span>
  </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>
<script class="next-config" data-name="chatra" type="application/json">{"enable":true,"async":true,"id":null}</script>
<script src="/js/third-party/chat/chatra.js"></script>
<script async src="https://call.chatra.io/chatra.js"></script>






  





</body>
</html>
